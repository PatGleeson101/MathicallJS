var Mathicall=function(e){"use strict";let t="Unknown",r={};function n(e,n){t=e;const c=t.split("(")[1].replace(")","").replace(" ","").replace("?","").split(",");r={};for(let e=0;e<c.length;e++)r[params[e]]=n[e]}function c(){r={},t="Unknown"}function o(){console.warn.apply(console,arguments)}Object.freeze((function(){console.log.apply(console,arguments)})),Object.freeze(n),Object.freeze(c),Object.freeze(o);const f=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];function a(e){const n=r[e];if(n.constructor!==Number)throw`${t}: ${e} must be of type Number.`;if(!isFinite(n))throw`${t}: ${e} cannot be NaN or Infinity.`}function i(e,n){const c=r[e];if(f.includes(c.constructor)||Array.isArray(c)){const r=c.length;if(r!==n)throw`${t}: ${e} has incorrect length`;0===r&&o(`${t}: ${e} is empty.`);for(let n=0;n<r;n++){c[n];if(c.constructor!==Number)throw`${t}: ${e} must an array of Numbers.`;if(!isFinite(c))throw`${t}: ${e} contains NaN or Infinity.`}}throw`${t}: ${e} must be an Array or TypedArray.`}function s(e){const n=r[e];if(!Number.isInteger(n))throw`${t}: ${e} must be an integer of type Number.`}function l(e){const n=r[e];if(a(e),n<=0)throw`${t}: ${e} must be positive.`}function b(e){const n=r[e];if(a(e),n<0)throw`${t}: ${e} must be non-negative.`}function z(e){const n=r[e];i(e);const c=n.length;if(c<2)throw`${t}: ${e} must have two components.`;c>2&&console.warn(`${t}: ${e} contains additional values which will be ignored.`),n[0]<0&&console.warn(`${t}: ${e} expressed with negative magnitude.`)}function j(e){const n=r[e];i(e);const c=n.length;if(c<2)throw`${t}: ${e} must have two components.`;c>2&&console.warn(`${t}: ${e} contains additional values which will be ignored.`)}function O(e){s(e),l(e)}function g(e,n,c){i(e);const o=r[e];if(!Number.isInteger(o.nrows)||o.nrows<1)throw`${t}: ${e}.nrows is invalid`;if(!Number.isInteger(o.ncols)||o.ncols<1)throw`${t}: ${e}.ncols is invalid`;if(o.nrows*o.ncols!==o.length)throw`${t}: ${e}.length does not match ${e}.nrows * ${e}.ncols`;if(o.nrows!==n||o.ncols!==c)throw`${t}: ${e} has incorrect dimensions`}function d(e){e>=I&&o(`${t}: overflowed Number.MAX_VALUE`)}function v(e){e>N&&o(`${t}: overflowed Number.MAX_SAFE_INTEGER`)}function m(e){void 0===e&&o(`${t}: output undefined`)}function w(e,n){const c=r[e],o=r[n],f=c.length;if(0!==f&&!0===o){sgn=Math.sign(c[f-1]-c[0]);for(let r=1;r<f;r++){const o=Math.sign(c[r]-c[r-1]);if(0!==o&&o!==sgn)throw`${t}: ${n} set to true, but ${e} unsorted`}}}function h(e){const n=r[e];if(void 0!==n){if(n.constructor!==Number)throw`${t}: If provided, ${e} must be of type Number.`;if(!isFinite(n))throw`${t}: ${e} cannot be NaN or Infinity.`}}function y(e,n){const c=r[e];if(void 0!==c&&(i(c),c.length!==n))throw`${t}: ${e} has incorrect length`}function A(e){const n=r[e];if(void 0!==n&&!0!==n&&!1!==n)throw`${t}: ${e} must be a boolean`}function _(e){void 0!==r[e]&&b(e)}function p(e){void 0!==r[e]&&(b(e),s(e))}Object.freeze(a),Object.freeze(i),Object.freeze(s),Object.freeze(l),Object.freeze(b),Object.freeze((function(e){i(e)})),Object.freeze((function(e){const n=r[e];i(e),n[0]<0&&console.warn(`${t}: ${e} expressed with negative magnitude.`)})),Object.freeze((function(e){const n=r[e];if(!0!==n&&!1!==n)throw`${t}: ${e} must be a boolean value.`})),Object.freeze(z),Object.freeze(j),Object.freeze(g),Object.freeze(O),Object.freeze(d),Object.freeze(v),Object.freeze(m),Object.freeze(h),Object.freeze(w),Object.freeze(y),Object.freeze(A),Object.freeze(p),Object.freeze(_);const F=Math.E,x=Math.LN2,$=Math.SQRT2,M=Math.PI,N=Number.MAX_SAFE_INTEGER,I=Number.MAX_VALUE,E=Number.EPSILON,C=Math.abs,U=Math.sign,k=Math.round,P=Math.trunc,q=Math.ceil,R=Math.floor,X=Math.sin,V=Math.asin,T=Math.cos,G=Math.acos,S=Math.tan,L=Math.atan,D=Math.atan2,B=Math.sqrt,Q=Math.cbrt,Y=Math.hypot,H=Math.pow,W=Math.exp,J=Math.log,K=Math.log2,Z=Math.log10,ee=Math.max,te=Math.min,re=Math.random,ne=180/M,ce=1/ne,oe=2*M,fe=.5*M,ue=1/M;function ae(e,t,r){return e+(t-e)*r}function ie(e,t){return(e%t+t)%t}function se(e){return e-P(e)}function le(e){return e*ne}function be(e){return e*ce}function ze(e,t,r){const n=r[0],c=t[0];return n+(r[1]-n)*(e-c)/(t[1]-c)}function je(e,t,r){return setContext("lerp(x, y, r)",arguments),a("x"),a("y"),a("r"),c(),ae(e,t,r)}function Oe(e,t){return setContext("mod(x, m)",arguments),a("x"),a("m"),c(),ie(e,t)}function ge(e){return setContext("fract(x)",arguments),a("x"),c(),se(e)}function de(e){return setContext("deg(radians)",arguments),a("radians"),c(),le(e)}function ve(e){return setContext("rad(degrees)",arguments),a("degrees"),c(),be(e)}function me(e,t,r){if(setContext("linmap(x, domain, range)",arguments),a("x"),i("domain"),i("range"),t[0]>t[1])throw"linmap(x, domain, range): invalid domain";if(r[0]>r[1])throw"linmap(x, domain, range): invalid range";return c(),ze(e,t,r)}Object.freeze(ae),Object.freeze(ie),Object.freeze(se),Object.freeze(le),Object.freeze(be),Object.freeze(ze),Object.freeze(je),Object.freeze(Oe),Object.freeze(ge),Object.freeze(de),Object.freeze(ve),Object.freeze(me);var we=Object.freeze({__proto__:null,lerp:je,mod:Oe,fract:ge,deg:de,rad:ve,linmap:me}),he=Object.freeze({__proto__:null,debug:we,E:F,LN2:x,SQRT2:$,PI:M,MAX_SAFE_INTEGER:N,MAX_VALUE:I,EPSILON:E,abs:C,sign:U,round:k,trunc:P,ceil:q,floor:R,sin:X,asin:V,cos:T,acos:G,tan:S,atan:L,atan2:D,sqrt:B,cbrt:Q,hypot:Y,pow:H,exp:W,ln:J,log2:K,log10:Z,max:ee,min:te,random:re,RAD_TO_DEG:ne,DEG_TO_RAD:ce,TWO_PI:oe,HALF_PI:fe,INV_PI:ue,lerp:ae,mod:ie,fract:se,deg:le,rad:be,linmap:ze});function ye(e=170){if(e<0)return[];const t=e+1,r=new Float64Array(t);r[0]=1;for(let e=1;e<t;e++)r[e]=e*r[e-1];return r}function Ae(e=30){const t=new Float64Array(.5*(e+1)*(e+2));let r=-1;for(let n=0;n<=e;n++){t[r++]=1;for(let e=1;e<n;e++)t[r]=t[r-n-1]+t[r-n],r++;t[r++]=1}return t}const _e=ye();let pe,Fe;function xe(e){pe=e,Fe=Ae(e)}function $e(e){if(!(e<0))return e>170?I:_e[e]}function Me(e,t){if(t>e||e<0||t<0)return 0;if(e<=pe)return Fe[.5*e*(e+1)+t];const r=te(t,e-t);if(r>514)return I;const n=e-r;let c=1,o=1;for(;o<=r;)c*=(n+o)/o++;return c}function Ne(e,t){if(t>e||e<0||t<0)return 0;if((t=e-t)>170)return I;if(e<171)return k(_e[e]/_e[t]);let r=1;for(t<160&&(r=k(_e[170]/_e[t]),t=170);t<e;)r*=++t;return r}function Ie(e,t){if(e=C(e),t=C(t),0===e)return t;if(0===t)return e;if(e<4294967296&&t<4294967296){let r=0;for(;0==(1&(e|t));)e>>>=1,t>>>=1,r++;for(;0==(1&e);)e>>>=1;for(;0!==t;){for(;0==(1&t);)t>>>=1;if(e>t){const r=e;e=t,t=r}t-=e}return e<<r}for(;e!==t;)e>t?e-=t:t-=e;return e}function Ee(e,t){return 0===e||0===t?0:C(e/Ie(e,t)*t)}function Ce(e,t,r){if(t=C(t),1===r)return 0;{let n=1;for(e%=r;t>0;)1&t&&(n=n*e%r),t>>=1,e=e**2%r;return n}}function Ue(e){n("factorial(n)",arguments),s("n"),b("n");const t=$e(e);return d(t),v(t),c(),t}function ke(e,t){n("choose(n, r)",arguments),s("n"),s("r");const r=Me(e,t);return d(r),v(r),c(),r}function Pe(e,t){n("permute(n, r)",arguments),s("n"),s("r");const r=Ne(e,t);return d(r),v(r),c(),r}function qe(e,t){return n("gcd(a, b)",arguments),s("a"),s("b"),c(),Ie(e,t)}function Re(e,t){return n("lcm(a, b)",arguments),s("a"),s("b"),c(),Ee(e,t)}function Xe(e,t,r){return n("mpow(base, exp, m)",arguments),s("base"),s("exp"),b("exp"),s("m"),c(),Ce(e,t,r)}xe(30),Object.freeze(ye),Object.freeze(Ae),Object.freeze(xe),Object.freeze($e),Object.freeze(Me),Object.freeze(Ne),Object.freeze(Ie),Object.freeze(Ee),Object.freeze(Ce),Object.freeze(Ue),Object.freeze(ke),Object.freeze(Pe),Object.freeze(qe),Object.freeze(Re),Object.freeze(Xe);var Ve=Object.freeze({__proto__:null,factorial:Ue,choose:ke,permute:Pe,gcd:qe,lcm:Re,mpow:Xe}),Te=Object.freeze({__proto__:null,debug:Ve,computeFactorials:ye,computeBinomials:Ae,precomputeBinomials:xe,factorial:$e,choose:Me,permute:Ne,gcd:Ie,lcm:Ee,mpow:Ce});function Ge(e){return new Float64Array(e)}function Se(e,t){let r=0;const n=e.length;for(let c=0;c<n;c++)r+=e[c]*t[c];return r}function Le(e,t){return e[0]*t[0]+e[1]*t[1]}function De(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Be(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Qe(e,t,r=new Float64Array(3)){return r[0]=e[1]*t[2]-e[2]*t[1],r[1]=e[2]*t[0]-e[0]*t[2],r[2]=e[0]*t[1]-e[1]*t[0],r}function Ye(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]+t[c];return r}function He(e,t,r=new Float64Array(2)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function We(e,t,r=new Float64Array(3)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function Je(e,t,r=new Float64Array(4)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function Ke(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]-t[c];return r}function Ze(e,t,r=new Float64Array(2)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}function et(e,t,r=new Float64Array(3)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function tt(e,t,r=new Float64Array(4)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function rt(e){return Y(...e)}function nt(e){return Y(e[0],e[1])}function ct(e){return Y(e[0],e[1],e[2])}function ot(e){return Y(e[0],e[1],e[2],e[3])}function ft(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]*t;return r}function ut(e,t,r=new Float64Array(2)){return r[0]=e[0]*t,r[1]=e[1]*t,r}function at(e,t,r=new Float64Array(3)){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function it(e,t,r=new Float64Array(4)){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function st(e,t){const r=rt(e);return 0===r?void 0:ft(e,1/r,t)}function lt(e,t){const r=nt(e);return 0===r?void 0:ut(e,1/r,t)}function bt(e,t){const r=ct(e);return 0===r?void 0:at(e,1/r,t)}function zt(e,t){const r=ot(e);return 0===r?void 0:it(e,1/r,t)}function jt(e,t){const r=rt(e)*rt(t);return 0===r?void 0:G(Se(e,t)/r)}function Ot(e,t){const r=nt(e)*nt(t);return 0===r?void 0:G(Le(e,t)/r)}function gt(e,t){const r=ct(e)*ct(t);return 0===r?void 0:G(De(e,t)/r)}function dt(e,t){const r=ot(e)*rt(t);return 0===r?void 0:G(Be(e,t)/r)}function vt(e,t=new Float64Array(e.length)){const r=e.length;for(let n=0;n<r;n++)t[n]=se(e[n]);return t}function mt(e,t=new Float64Array(2)){return t[0]=se(e[0]),t[1]=se(e[1]),t}function wt(e,t=new Float64Array(3)){return t[0]=se(e[0]),t[1]=se(e[1]),t[2]=se(e[2]),t}function ht(e,t=new Float64Array(4)){return t[0]=se(e[0]),t[1]=se(e[1]),t[2]=se(e[2]),t[3]=se(e[3]),t}function yt(e,t=new Float64Array(2)){return t[0]=nt(e),t[1]=D(e[1],e[0])+M,t}function At(e,t){return n("dot(vec1, vec2)",arguments),i("vec1"),i("vec2",e.length),c(),Se(e,t)}function _t(e,t){return n("dot2(vec1, vec2)",arguments),i("vec1",2),i("vec2",2),c(),Le(e,t)}function pt(e,t){return n("dot3(vec1, vec2)",arguments),i("vec1",3),i("vec2",3),c(),De(e,t)}function Ft(e,t){return n("dot4(vec1, vec2)",arguments),i("vec1",4),i("vec2",4),c(),Be(e,t)}function xt(e,t,r){return n("cross3(vec1, vec2, ?target)",arguments),i("vec1",3),i("vec2",3),y("target",3),c(),Qe(e,t,r)}function $t(e,t,r){return n("add(vec1, vec2, ?target)",arguments),i("vec1"),i("vec2",e.length),y("target",e.length),c(),Ye(e,t,r)}function Mt(e,t,r){return n("add2(vec1, vec2, ?target)",arguments),i("vec1",2),i("vec2",2),y("target",2),c(),He(e,t,r)}function Nt(e,t,r){return n("add3(vec1, vec2, ?target)",arguments),i("vec1",3),i("vec2",3),y("target",3),c(),We(e,t,r)}function It(e,t,r){return n("add4(vec1, vec2, ?target)",arguments),i("vec1",4),i("vec2",4),y("target",4),c(),Je(e,t,r)}function Et(e,t,r){return n("sub(vec1, vec2, ?target)",arguments),i("vec1",2),i("vec2",e.length),y("target",e.length),c(),Ke(e,t,r)}function Ct(e,t,r){return n("sub2(vec1, vec2, ?target)",arguments),i("vec1",2),i("vec2",2),y("target",2),c(),Ze(e,t,r)}function Ut(e,t,r){return n("sub3(vec1, vec2, ?target)",arguments),i("vec1",3),i("vec2",3),y("target",3),c(),et(e,t,r)}function kt(e,t,r){return n("sub4(vec1, vec2, ?target)",arguments),i("vec1",4),i("vec2",4),y("target",4),c(),tt(e,t,r)}function Pt(e){return n("mag(vec)",arguments),i("vec"),c(),rt(e)}function qt(e){return n("mag2(vec)",arguments),i("vec",2),c(),nt(e)}function Rt(e){return n("mag3(vec)",arguments),i("vec",3),c(),ct(e)}function Xt(e){return n("mag4(vec)",arguments),i("vec",4),c(),ot(e)}function Vt(e,t,r){return n("scale(vec, k, ?target)",arguments),i("vec"),a("k"),y("target",e.length),ft(e,t,r)}function Tt(e,t,r){return n("scale2(vec, k, ?target)",arguments),i("vec",2),a("k"),y("target",2),ut(e,t,r)}function Gt(e,t,r){return n("scale3(vec, k, ?target)",arguments),i("vec",3),a("k"),y("target",3),at(e,t,r)}function St(e,t,r){return n("scale4(vec, k, ?target)",arguments),i("vec",4),a("k"),y("target",4),it(e,t,r)}function Lt(e,t){return n("normalize(vec, ?target)",arguments),i("vec"),y("target",e.length),st(e,t)}function Dt(e,t){return n("normalize2(vec, ?target)",arguments),i("vec",2),y("target",2),lt(e,t)}function Bt(e,t){return n("normalize3(vec, ?target)",arguments),i("vec",3),y("target",3),bt(e,t)}function Qt(e,t){return n("normalize4(vec, ?target)",arguments),i("vec",4),y("target",4),zt(e,t)}function Yt(e,t){return n("angle(vec1, vec2)",arguments),i("vec1"),i("vec2",e.length),jt(e,t)}function Ht(e,t){return n("angle2(vec1, vec2)",arguments),i("vec1",2),i("vec2",2),Ot(e,t)}function Wt(e,t){return n("angle3(vec1, vec2)",arguments),i("vec1",3),i("vec2",3),gt(e,t)}function Jt(e,t){return n("angle4(vec1, vec2)",arguments),i("vec1",4),i("vec2",4),dt(e,t)}function Kt(e,t){return n("fract(vec, ?target)",arguments),i("vec"),y("target",e.length),vt(e,t)}function Zt(e,t){return n("fract2(vec, ?target)",arguments),i("vec",2),y("target",2),mt(e,t)}function er(e,t){return n("fract3(vec, ?target)",arguments),i("vec",3),y("target",3),wt(e,t)}function tr(e,t){return n("fract4(vec, ?target)",arguments),i("vec",4),y("target",4),ht(e,t)}function rr(e,t){return n("polar2(vec, ?target)",arguments),i("vec",2),y("target",2),yt(e,t)}Object.freeze(Ge),Object.freeze(Se),Object.freeze(Le),Object.freeze(De),Object.freeze(Be),Object.freeze(Qe),Object.freeze(Ye),Object.freeze(He),Object.freeze(We),Object.freeze(Je),Object.freeze(Ke),Object.freeze(Ze),Object.freeze(et),Object.freeze(tt),Object.freeze(rt),Object.freeze(nt),Object.freeze(ct),Object.freeze(ot),Object.freeze(ft),Object.freeze(ut),Object.freeze(at),Object.freeze(it),Object.freeze(st),Object.freeze(lt),Object.freeze(bt),Object.freeze(zt),Object.freeze(jt),Object.freeze(Ot),Object.freeze(gt),Object.freeze(dt),Object.freeze(vt),Object.freeze(mt),Object.freeze(wt),Object.freeze(ht),Object.freeze(yt),Object.freeze(At),Object.freeze(_t),Object.freeze(pt),Object.freeze(Ft),Object.freeze(xt),Object.freeze($t),Object.freeze(Mt),Object.freeze(Nt),Object.freeze(It),Object.freeze(Et),Object.freeze(Ct),Object.freeze(Ut),Object.freeze(kt),Object.freeze(Pt),Object.freeze(qt),Object.freeze(Rt),Object.freeze(Xt),Object.freeze(Vt),Object.freeze(Tt),Object.freeze(Gt),Object.freeze(St),Object.freeze(Lt),Object.freeze(Dt),Object.freeze(Bt),Object.freeze(Qt),Object.freeze(Yt),Object.freeze(Ht),Object.freeze(Wt),Object.freeze(Jt),Object.freeze(Kt),Object.freeze(Zt),Object.freeze(er),Object.freeze(tr),Object.freeze(rr);var nr=Object.freeze({__proto__:null,dot:At,dot2:_t,dot3:pt,dot4:Ft,cross3:xt,add:$t,add2:Mt,add3:Nt,add4:It,sub:Et,sub2:Ct,sub3:Ut,sub4:kt,mag:Pt,mag2:qt,mag3:Rt,mag4:Xt,scale:Vt,scale2:Tt,scale3:Gt,scale4:St,normalize:Lt,normalize2:Dt,normalize3:Bt,normalize4:Qt,angle:Yt,angle2:Ht,angle3:Wt,angle4:Jt,fract:Kt,fract2:Zt,fract3:er,fract4:tr,toPolar2:rr}),cr=Object.freeze({__proto__:null,debug:nr,Vector:Ge,dot:Se,dot2:Le,dot3:De,dot4:Be,cross3:Qe,add:Ye,add2:He,add3:We,add4:Je,sub:Ke,sub2:Ze,sub3:et,sub4:tt,mag:rt,mag2:nt,mag3:ct,mag4:ot,scale:ft,scale2:ut,scale3:at,scale4:it,normalize:st,normalize2:lt,normalize3:bt,normalize4:zt,angle:jt,angle2:Ot,angle3:gt,angle4:dt,fract:vt,fract2:mt,fract3:wt,fract4:ht,toPolar2:yt});function or(e,t=new Float64Array(2)){const r=e[0];return r<0?(t[0]=-r,t[1]=ie(e[1]+M,oe)):r>0?(t[0]=r,t[1]=ie(e[1],oe)):(t[0]=0,t[1]=0),t}function fr(e,t){return e[0]*t[0]*T(e[1]-t[1])}function ur(e){return e[0]}function ar(e,t,r=new Float64Array(2)){return r[0]=e[0]*t,r[1]=e[1],or(r,r)}function ir(e,t=new Float64Array(2)){if(0!==e[0])return t[0]=1,t[1]=e[1],t}function sr(e,t=new Float64Array(2)){const r=e[0],n=e[1];return t[0]=r*T(n),t[1]=r*X(n),t}Object.freeze(or),Object.freeze(fr),Object.freeze(ur),Object.freeze(ar),Object.freeze(ir),Object.freeze(sr);var lr=Object.freeze({__proto__:null,simplify2:or,dot2:fr,mag:ur,scale2:ar,normalize2:ir,toRect2:sr}),br=Object.freeze({__proto__:null,rect:cr,polar:lr,debug:nr,Vector:Ge,dot:Se,dot2:Le,dot3:De,dot4:Be,cross3:Qe,add:Ye,add2:He,add3:We,add4:Je,sub:Ke,sub2:Ze,sub3:et,sub4:tt,mag:rt,mag2:nt,mag3:ct,mag4:ot,scale:ft,scale2:ut,scale3:at,scale4:it,normalize:st,normalize2:lt,normalize3:bt,normalize4:zt,angle:jt,angle2:Ot,angle3:gt,angle4:dt,fract:vt,fract2:mt,fract3:wt,fract4:ht,toPolar2:yt});const zr=64;function jr(e){const t=e.length;let r=0;for(let n=0;n<t;n++)r+=e[n];return r}function Or(e,t=!1){const r=e.length;if(t)return te(e[0],e[r-1]);let n=e[0],c=0;for(let t=1;t<r;t++)c=e[t],c<n&&(n=c);return n}function gr(e,t=!1){const r=e.length;if(t)return ee(e[0],e[r-1]);let n=e[0],c=0;for(let t=1;t<r;t++)c=e[t],c>n&&(n=c);return n}function dr(e,t=!1){const r=e.length;if(0===r)return;if(t)return e[0]>=e[r-1]?0:r-1;let n=0,c=e[0]-1;for(let t=0;t<r;t++){const r=e[t];r>c&&(c=r,n=t)}return n}function vr(e,t=!1){const r=e.length;if(0===r)return;if(t)return e[0]<=e[r-1]?0:r-1;let n=0,c=e[0]+1;for(let t=0;t<r;t++){const r=e[t];r<c&&(c=r,n=t)}return n}function mr(e){const t=e.length;let r=1;for(let n=1;n<t;n++)r*=e[n];return r}function wr(e,t=!1){const r=e.length;if(t){const t=new Float64Array(r);let n=0,c=0,o=e[0],f=0;for(;f<r;)for(t[n++]=o,c=o;o===c;)o=e[f++];return t.slice(0,n)}{const t={};let n=0;for(let c=0;c<r;c++)n=e[c],t[n]=n;return new Float64Array(Object.values(t))}}function hr(e,t,r=!1){const n=e.length;if(!r||n<=zr){for(let r=0;r<n;r++)if(e[r]===t)return r}else{let r=0,c=n-1,o=e[r],f=e[c],u=0,a=0;if(o>f){if(o<t||f>t)return-1;for(;c-r>zr;)u=R(.5*(r+c)),a=e[u],a>t?r=u:c=u}else{if(o>t||f<t)return-1;for(;c-r>zr;)u=R(.5*(r+c)),a=e[u],a<t?r=u:c=u}for(;r<=c;){if(e[r]===t)return r;r++}}return-1}function yr(e,t,r=!1){const n=e.length,c=t.length;if(!r||n+c<zr){const r={};let o=0;for(let t=0;t<n;t++)o=e[t],r[o]=o;for(let e=0;e<c;e++)o=t[e],r[o]=o;return new Float64Array(Object.values(r))}{const r=[];let o=0,f=0,u=0,a=0,i=NaN,s=NaN;for(;o<n&&f<c;){for(u=e[o],a=t[f],u<a?(u!==i&&(r.push(u),i=u),o++):u>a?(a!==s&&(r.push(a),s=a),f++):(u!==i&&r.push(u),o++,f++);o<n;)r.push(e[o++]);for(;f<c;)r.push(t[f++]);return new Float64Array(r)}}}function Ar(e,t){const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function _r(e,t=new Uint8Array(e.length)){const r=new Uint32Array(256),n=e.length;for(let t=0;t<n;t++)r[e[t]]+=1;let c=0;for(let e=0;e<256;e++){const n=r[e];for(let r=0;r<n;r++)t[c++]=e}return t}function pr(e,t,r=!1){const n=e.length;let c=0;if(!r||e.length<=zr)for(let r=0;r<n;r++)e[r]===t&&(c+=1);else{let r,o=0,f=n-1,u=e[o],a=e[f],i=0,s=0;if(u>a){if(u<t||a>t)return 0;for(;f-o>zr;)if(i=R(.5*(o+f)),s=e[i],s>t)o=i+1;else{if(!(s<t)){r=i;break}f=i-1}}else{if(u>t||a<t)return 0;for(;f-o>zr;)if(i=R(.5*(o+f)),s=e[i],s<t)o=i+1;else{if(!(s>t)){r=i;break}f=i-1}}if(void 0!==r){let n=r;for(;n-o>zr;)i=R(.5*(o+n)),s=e[i],s!==t?o=i:n=i;for(;o<=n&&e[o]!==t;)o++;let u=r;for(;f-u>zr;)i=R(.5*(u+f)),s=e[i],s!==t?f=i:u=i;for(;f>=u&&e[f]!==t;)f--;c=f-o+1}else for(let r=o;r<=f;r++)e[r]===t&&(c+=1)}return c}function Fr(e,t){const r=new Float64Array(e*t);return r.nrows=e,r.ncols=t,r}function xr(e,t,r){const n=new Float64Array(e*t);return n.fill(r),n.nrows=e,n.ncols=t,n}function $r(e){const t=e*e,r=e+1,n=new Float64Array(t);for(let e=0;e<t;e+=r)n[e]=1;return n.nrows=e,n.ncols=e,n}function Mr(e,t=new Float64Array(e.length*e[0].length)){const r=e.length,n=e[0].length;for(let c=0;c<r;c++)for(let o=0;o<n;o++)t[c*r+o]=e[c][o];return t.nrows=r,t.ncols=n,t}function Nr(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]*t;return r.nrows=e.nrows,r.ncols=e.ncols,r}function Ir(e,t=new Float64Array(4)){t[0]=e[0],t[3]=e[3];const r=e[1];return t[1]=e[2],t[2]=r,t.nrows=2,t.ncols=2,t}function Er(e,t=new Float64Array(9)){t[0]=e[0],t[4]=e[4],t[8]=e[8];let r=e[1];return t[1]=e[3],t[3]=r,r=e[2],t[2]=e[6],t[6]=r,r=e[5],t[5]=e[7],t[7]=r,t.nrows=3,t.ncols=3,t}function Cr(e,t=new Float64Array(16)){t[0]=e[0],t[5]=e[5],t[10]=e[10],t[15]=e[15];let r=e[1];return t[1]=e[4],t[4]=r,r=e[2],t[2]=e[8],t[8]=r,r=e[3],t[3]=e[12],t[12]=r,r=e[6],t[6]=e[9],t[9]=r,r=e[7],t[7]=e[13],t[13]=r,r=e[11],t[11]=e[14],t[14]=r,t.nrows=4,t.ncols=4,t}function Ur(e,t){const r=e.nrows,n=e.ncols,c=t.ncols,o=new Float64Array(r*c);o.nrows=r,o.ncols=c;let f=0,u=0,a=0;for(let i=0;i<r;i++)for(let r=0;r<c;r+=1){f=0,u=n*i,a=r;for(let r=0;r<n;r+=1)f+=e[u]*t[a],u+=1,a+=c;o[i*c+r]=f}return o}function kr(e){return[e.nrows,e.ncols]}function Pr(e){return e[0]*e[3]-e[1]*e[2]}function qr(e,t=new Float64Array(4)){const r=e[0],n=e[1],c=e[2],o=e[3],f=r*o-n*c;if(0===f)return;const u=1/f;return t[0]=o*u,t[3]=r*u,t[1]=-n*u,t[2]=-c*u,t.nrows=2,t.ncols=2,t}function Rr(e,t){const r=t.ncols,n=e.length;if(n!==t.nrows)return;const c=new Float64Array(r);let o=0;for(let f=0;f<n;f++){vi=e[f];for(let e=0;e<r;e++)c[e]+=vi*t[o++]}return c}function Xr(e,t){const r=new Float64Array(2),n=e[0],c=e[1];return r[0]=n*t[0]+c*t[2],r[0]=n*t[1]+c*t[3],r}function Vr(e,t){const r=e.ncols,n=e.length;if(t.length!==r)return;const c=new Float64Array(r);for(let o=0;o<r;o++){vj=t[o];let f=0;for(let t=o;t<n;t+=r)c[f++]+=vj*e[t]}return c}function Tr(e,t){return e.nrows===t.nrows&&e.ncols===t.ncols&&Ar(e,t)}function Gr(e,t){return n("zeros(m, n)",arguments),O("m"),O("n"),c(),Fr(e,t)}function Sr(e,t,r){return n("constant(m, n, value)",arguments),O("m"),O("n"),a("value"),c(),xr(e,t,r)}function Lr(e){return n("identity(m)",arguments),O("m"),c(),$r(e)}function Dr(e,t,r){return n("scale(mat, k, target)",arguments),g("mat"),a("k"),y("target",e.length),c(),Nr(e,t,r)}function Br(e,t){return n("transpose2x2(mat, target)",arguments),g("mat",2,2),y("target",e.length),c(),Ir(e,t)}function Qr(e,t){return n("transpose3x3(mat, target)",arguments),g("mat",3,3),y("target",e.length),c(),Er(e,t)}function Yr(e,t){return n("transpose4x4(mat, target)",arguments),g("mat",[4,4]),y("target",e.length),c(),Cr(e,t)}function Hr(e,t){return n("mult(mat1, mat2)",arguments),g("mat1"),g("mat2",e.ncols),c(),Ur(e,t)}function Wr(e){return n("size(mat)",arguments),g("mat"),c(),kr(e)}function Jr(e){return n("det2x2(mat)",arguments),g("mat",2,2),c(),Pr(e)}function Kr(e,t){return n("inverse2(mat, target)",arguments),g("mat",2,2),y("target",4),c(),qr(e,t)}Object.freeze(jr),Object.freeze(Or),Object.freeze(gr),Object.freeze(mr),Object.freeze(wr),Object.freeze(hr),Object.freeze(yr),Object.freeze(Ar),Object.freeze(_r),Object.freeze(vr),Object.freeze(dr),Object.freeze(pr),Object.freeze(Fr),Object.freeze(xr),Object.freeze($r),Object.freeze(Mr),Object.freeze(Nr),Object.freeze(Ir),Object.freeze(Er),Object.freeze(Cr),Object.freeze(Ur),Object.freeze((function(e,t,r=new Float64Array(e.nrows*e.ncols)){const n=Ye(e,t,r);return n.nrows=e.nrows,n.ncols=e.ncols,n})),Object.freeze((function(e,t,r=new Float64Array(e.nrows*e.ncols)){const n=Ke(e,t,r);return n.nrows=e.nrows,n.ncols=e.ncols,n})),Object.freeze(kr),Object.freeze(Pr),Object.freeze((function(e){const{a11:t,a12:r,a13:n,a21:c,a22:o,a23:f,a31:u,a32:a,a33:i}=e;return t*(i*o-f*a)+r*(u*f-c*i)+n*(a*c-o*u)})),Object.freeze(qr),Object.freeze(Rr),Object.freeze(Xr),Object.freeze(Vr),Object.freeze(Tr),Object.freeze(Gr),Object.freeze(Sr),Object.freeze(Lr),Object.freeze(Dr),Object.freeze(Br),Object.freeze(Qr),Object.freeze(Yr),Object.freeze(Hr),Object.freeze(Wr),Object.freeze(Jr),Object.freeze(Kr);var Zr=Object.freeze({__proto__:null,zeros:Gr,constant:Sr,identity:Lr,scale:Dr,transpose2x2:Br,transpose3x3:Qr,transpose4x4:Yr,mult:Hr,size:Wr,det2x2:Jr,inverse2x2:Kr}),en=Object.freeze({__proto__:null,debug:Zr,zeros:Fr,constant:xr,identity:$r,flatten:Mr,scale:Nr,transpose2x2:Ir,transpose3x3:Er,transpose4x4:Cr,mult:Ur,size:kr,det2x2:Pr,inverse2x2:qr,vmult:Rr,vmult2x2:Xr,multv:Vr,areEqual:Tr});function tn(e){return e[0]}function rn(e){return e[1]}function nn(e){return D(e[1],e[0])}function cn(e){return Y(e[0],e[1])}function on(e,t=new Float64Array(2)){return t[0]=e[0],t[1]=-e[1],t}function fn(e,t=new Float64Array(2)){return t[0]=-e[0],t[1]=-e[1],t}function un(e,t,r=new Float64Array(2)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function an(e,t,r=new Float64Array(2)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}function sn(e,t,r=new Float64Array(2)){const n=e[0],c=e[1],o=t[0],f=t[1];return r[0]=n*o-c*f,r[1]=n*f+o*c,r}function ln(e,t,r=new Float64Array(2)){return r[0]=e[0]*t,r[1]=e[1]*t,r}function bn(e,t,r=new Float64Array(2)){const n=e[0],c=e[1],o=t[0],f=t[1],u=o*o+f*f;if(0===u)return;const a=1/u;return r[0]=(n*o+c*f)*a,r[1]=(-n*f-o*c)*a,r}function zn(e,t=new Float64Array(2)){const r=e[0],n=e[1],c=r*r+n*n;if(0===c)return;const o=1/c;return t[0]=r*o,t[1]=-n*o,t}function jn(e,t=new Float64Array(2)){const r=e[0],n=e[1],c=Y(r,n);return t[0]=c,t[1]=D(n,r),t}function On(e,t){return setContext("conj(z, ?target)",arguments),j("z"),y("target",2),c(),on(e,t)}function gn(e){return setContext("real(z)",arguments),j("z"),c(),tn(e)}function dn(e){return setContext("imag(z)",arguments),j("z"),c(),rn(e)}function vn(e){return setContext("arg(z)",arguments),j("z"),c(),nn(e)}function mn(e){return setContext("abs(z)",arguments),j("z"),c(),cn(e)}function wn(e,t,r){return setContext("add(z1, z2, ?target)",arguments),j("z1"),j("z2"),y("target",2),c(),un(e,t,r)}function hn(e,t,r){return setContext("sub(z1, z2, ?target)",arguments),j("z1"),j("z2"),y("target",2),c(),an(e,t,r)}function yn(e,t,r){return setContext("mult(z1, z2, ?target)",arguments),j("z1"),j("z2"),y("target",2),c(),sn(e,t,r)}function An(e,t,r){return setContext("scale(z, k, ?target)",arguments),j("z"),a("k"),y("target",2),c(),ln(e,t,r)}function _n(e,t,r){setContext("div(z1, z2, ?target)",arguments),j("z1"),j("z2"),y("target",2);const n=bn(e,t,r);return m(n),c(),n}function pn(e,t){setContext("inverse(z, ?target)",arguments),j("z"),y("target",2);const r=zn(e,t);return m(r),c(),r}function Fn(e,t){setContext("toPolar(z, ?target)",arguments),j("z"),y("target",2);const r=jn(e,t);return m(r),c(),r}Object.freeze(on),Object.freeze(tn),Object.freeze(rn),Object.freeze(nn),Object.freeze(cn),Object.freeze(un),Object.freeze(an),Object.freeze(sn),Object.freeze(ln),Object.freeze(bn),Object.freeze(zn),Object.freeze(jn),Object.freeze(fn),Object.freeze(On),Object.freeze(gn),Object.freeze(dn),Object.freeze(vn),Object.freeze(mn),Object.freeze(wn),Object.freeze(hn),Object.freeze(yn),Object.freeze(An),Object.freeze(_n),Object.freeze(pn),Object.freeze(Fn);var xn=Object.freeze({__proto__:null,conj:On,real:gn,imag:dn,arg:vn,abs:mn,add:wn,sub:hn,mult:yn,scale:An,div:_n,inverse:pn,toPolar:Fn}),$n=Object.freeze({__proto__:null,debug:xn,conj:on,real:tn,imag:rn,arg:nn,abs:cn,add:un,sub:an,mult:sn,scale:ln,div:bn,inverse:zn,toPolar:jn,negate:fn});function Mn(e){return(e%=oe)>M?e-oe:e<-M?e+oe:e}function Nn(e,t=new Float64Array(2)){return t[0]=e[0],t[1]=-e[1],t}function In(e){return e[0]*T(e[1])}function En(e){return e[0]*X(e[1])}function Cn(e){return Mn(e[1])}function Un(e){return C(e[0])}function kn(e,t,r=new Float64Array(2)){const n=e[0]*t,c=e[1];return n<0?(r[0]=-n,r[1]=Mn(c+M)):(r[0]=n,r[1]=Mn(c)),r}function Pn(e,t,r=new Float64Array(2)){const n=e[0]*t[0],c=e[1]+t[1];return n<0?(r[0]=-n,r[1]=Mn(c+M)):(r[0]=n,r[1]=Mn(c)),r}function qn(e,t,r=new Float64Array(2)){const n=t[0];if(0===n)return;const c=e[0]/n,o=e[1]-t[1];return c<0?(r[0]=-c,r[1]=Mn(o+M)):(r[0]=c,r[1]=Mn(o)),r}function Rn(e,t,r=new Float64Array(2)){const n=e[0],c=e[1];return n<0?(r[0]=H(-n,t),r[1]=Mn(t*(c+M))):(r[0]=H(n,t),r[1]=Mn(t*c)),r}function Xn(e,t=new Float64Array(2)){const r=e[0];if(0===r)return;const n=e[1];return r<0?(t[0]=-1/r,t[1]=Mn(-n-M)):(t[0]=1/r,t[1]=Mn(-n)),t}function Vn(e,t=new Float64Array(2)){const r=e[0],n=e[1];return t[0]=r*T(n),t[1]=r*X(n),t}function Tn(e,t){return n("conj(z, ?target)",arguments),y("target",2),z("z"),c(),Nn(e,t)}function Gn(e){return n("real(z)",arguments),z("z"),c(),In(e)}function Sn(e){return n("imag(z)",arguments),z("z"),c(),En(e)}function Ln(e){return n("arg(z)",arguments),z("z"),c(),Cn(e)}function Dn(e){return n("abs(z)",arguments),z("z"),c(),Un(e)}function Bn(e,t,r){return n("scale(z, k, ?target)",arguments),z("z"),a("k"),y("target",2),c(),kn(e,t,r)}function Qn(e,t,r){return n("mult(z1, z2, ?target)",arguments),z("z1"),z("z2"),y("target",2),Pn(e,t,r)}function Yn(e,t,r){n("div(z1, z2, ?target)",arguments),z("z1"),z("z2"),y("target",2);const o=qn(e,t,r);return m(o),c(),o}function Hn(e,t,r){return n("pow(z, n, ?target)",arguments),z("z"),a("n"),y("target",2),c(),Rn(e,t,r)}function Wn(e,t){return n("inverse(z, ?target)",arguments),z("z"),y("target",2),c(),Xn(e,t)}function Jn(e,t){return n("toRect(z, ?target)",arguments),z("z"),y("target",2),c(),Vn(e,t)}Object.freeze(Nn),Object.freeze(In),Object.freeze(En),Object.freeze(Cn),Object.freeze(Un),Object.freeze(kn),Object.freeze(Pn),Object.freeze(qn),Object.freeze(Rn),Object.freeze(Xn),Object.freeze(Vn),Object.freeze(Tn),Object.freeze(Gn),Object.freeze(Sn),Object.freeze(Ln),Object.freeze(Dn),Object.freeze(Bn),Object.freeze(Qn),Object.freeze(Yn),Object.freeze(Hn),Object.freeze(Wn),Object.freeze(Jn);var Kn=Object.freeze({__proto__:null,conj:Tn,real:Gn,imag:Sn,arg:Ln,abs:Dn,scale:Bn,mult:Qn,div:Yn,pow:Hn,inverse:Wn,toRect:Jn}),Zn=Object.freeze({__proto__:null,debug:Kn,conj:Nn,real:In,imag:En,arg:Cn,abs:Un,scale:kn,mult:Pn,div:qn,pow:Rn,inverse:Xn,toRect:Vn}),ec=Object.freeze({__proto__:null,rect:$n,polar:Zn,debug:xn,conj:on,real:tn,imag:rn,arg:nn,abs:cn,add:un,sub:an,mult:sn,scale:ln,div:bn,inverse:zn,toPolar:jn,negate:fn});function tc(e){n("sum(arr)",arguments),i("arr");const t=jr(e);return d(t),c(),t}function rc(e,t){return n("min(arr, ?sorted)",arguments),i("arr"),A("sorted"),w("arr","sorted"),c(),Or(e,t)}function nc(e,t){return n("max(arr, ?sorted)",arguments),i("arr"),A("sorted"),w("arr","sorted"),c(),gr(e,t)}function cc(e){return n("prod(arr)",arguments),i("arr"),c(),mr(e)}function oc(e,t){return n("unique(arr, ?sorted)",arguments),i("arr"),A("sorted"),w("arr","sorted"),c(),wr(e,t)}function fc(e,t,r){return n("indexOf(arr, value, ?sorted)",arguments),i("arr"),a("value"),A("sorted"),w("arr","sorted"),c(),hr(e,t,r)}function uc(e,t){return n("isEqual(arr1, arr2)",arguments),i("arr1"),i("arr2"),c(),Ar(e,t)}Object.freeze(tc),Object.freeze(rc),Object.freeze(nc),Object.freeze(cc),Object.freeze(oc),Object.freeze(fc),Object.freeze((function(e,t,r){return n("union(arr1, arr2, ?sorted)",arguments),i("arr1"),i("arr2"),A("sorted"),w("arr1","sorted"),w("arr2","sorted"),c(),yr(e,t,r)})),Object.freeze(uc),Object.freeze((function(e,t){if(n("sortUint8(arr, ?target)",arguments),e.constructor!==Uint8Array)throw"sortUint8(arr, ?target): arr must be a Uint8Array";return y("target",e.length),c(),_r(e,t)})),Object.freeze((function(e,t,r){return n("count(arr, value, ?sorted)",arguments),i("arr"),a("value"),A("sorted"),w("arr","sorted"),c(),pr(e,t,r)}));var ac=Object.freeze({__proto__:null,sum:tc,min:rc,max:nc,prod:cc,unique:oc,indexOf:fc,areEqual:uc}),ic=Object.freeze({__proto__:null,debug:ac,sum:jr,min:Or,max:gr,prod:mr,unique:wr,indexOf:hr,union:yr,areEqual:Ar,sortUint8:_r,imin:vr,imax:dr,count:pr}),sc=Object.freeze({__proto__:null});const lc=B(2/F),bc=48271,zc=2147483647;function jc(e=0,t=1,r){if(void 0===r)return e+(t-e)*re();{const n=new Float64Array(r);for(let c=0;c<r;c++)n[c]=e+(t-e)*re();return n}}function Oc(e,t,r){const n=q(e),c=R(t)+1-n;if(void 0===r)return R(n+re()*c);{const e=new Float64Array(r);for(let t=0;t<r;t++)e[t]=R(n+c*re());return e}}function gc(e=0,t=1,r){if(void 0!==r){const n=new Float64Array(r);let c=0;for(;c<r;){const r=re(),o=(2*re()-1)*lc/r;r*r<=W(-.5*o*o)&&(n[c++]=e+o*t)}return n}for(;;){const r=re(),n=(2*re()-1)*lc/r;if(r*r<=W(-.5*n*n))return e+n*t}}function dc(e=1,t){if(void 0===t)return-J(re())/e;{const r=new Float64Array(t);for(let n=0;n<t;n++)r[n]=-J(re())/e;return r}}function vc(e=0,t=1,r=Oc(1,4294967295)){let n,c,o;const f=function(e){return void 0!==e&&(r=R(C(e)),c=r,o=0),r},u=function(r=e,c=t){return n=((t=c)-(e=r))/2147483648,[e,t]};f(r),u(e,t);const a=function(t){if(void 0===t)return c=c*bc%zc,e+c*n;{const r=new Float64Array(t);for(let o=0;o<t;o++)c=c*bc%zc,r[o]=e+c*n;return r}};return a.seed=Object.freeze(f),a.range=Object.freeze(u),a.goto=Object.freeze((function(e){(e=mod(e,zc+1))<o&&(o=0,c=r);let t=e-o;if(t<700)for(let e=0;e<t;e++)c=mod(c*bc,zc);else{let e=1;for(;t>0;)t%2==1&&(e=e*bc%zc),t>>=1,e=e**2%zc;c=e*c%zc}return o=e,c/(zc+1)})),Object.freeze(a)}function mc(e=0,t=1,r=Oc(1,4294967295)){const n=new Uint32Array(1);let c;const o=function(e){return void 0!==e&&(r=P(e)||1,n[0]=r),r},f=function(r=e,n=t){return c=((t=n)-(e=r))/4294967296,[e,t]};o(r),f(e,t);const u=function(e){if(void 0===e)return n[0]^=n[0]<<13,n[0]^=n[0]<<17,n[0]^=n[0]<<5,n[0]*c;{const t=new Float64Array(e);for(let r=0;r<e;r++)n[0]^=n[0]<<13,n[0]^=n[0]<<17,n[0]^=n[0]<<5,t[r]=n[0]*c;return t}};return u.seed=Object.freeze(o),u.range=Object.freeze(f),Object.freeze(u)}function wc(e=0,t=1,r=Oc(1,4294967295)){const n=mc(0,1,r),c=function(r){if(void 0!==r){const c=new Float64Array(r);let o=0;for(;o<r;){const r=n(),f=(2*n()-1)*lc/r;r*r<=W(-.5*f*f)&&(c[o++]=e+f*t)}return c}for(;;){const r=n(),c=(2*n()-1)*lc/r;if(r*r<=W(-.5*c*c))return e+c*t}};return c.seed=n.seed,c.mean=Object.freeze((function(t=e){return e=t})),c.sd=Object.freeze((function(e=t){return t=e})),Object.freeze(c)}const hc=mc,yc=wc,Ac=function(e,t,r=Oc(1,4294967295)){const n=mc(q(e),R(t)+1,r),c=function(e){if(void 0===e)return R(n());{const t=n(e);for(let r=0;r<e;r++)t[r]=R(t[r]);return t}};return c.seed=n.seed,c.range=Object.freeze((function(r=e,c=t){return e=r,t=c,n.range(q(e),R(t)+1),[e,t]})),Object.freeze(c)};function _c(e=1,t=Oc(1,4294967295)){const r=mc(0,1,t),n=function(t){if(void 0===t)return-J(r())/e;{const n=new Float64Array(t);for(let c=0;c<t;c++)n[c]=-J(r())/e;return n}};return n.seed=r.seed,n.lambda=Object.freeze((function(t=e){return e=t})),Object.freeze(n)}function pc(e,t){const r=e.length;let n=0;if(void 0===t)for(let t=0;t<r;t++)n+=e[t];else for(let c=0;c<r;c++)n+=e[c]*t[c];return n}function Fc(e,t){const r=e.length;if(void 0===t)return pc(e)/r;{let n=0,c=0,o=0;for(let f=0;f<r;f++)o=t[f],n+=e[f]*o,c+=o;return n/c}}function xc(e,t,r=!0){const n=e.length;let c=0;const o=Fc(e,t);let f=n;if(void 0===t)for(let t=0;t<n;t++){const r=e[t]-o;c+=r*r}else{f=0;for(let r=0;r<n;r++){const n=t[r];f+=n;const o=e[r]-u;c+=n*o*o}}return r&&f>1&&(f-=1),c/f}function $c(e,t,r=!0){return B(xc(e,t,r))}function Mc(e,t,r=!0){meanX=Fc(e),meanY=Fc(t);const n=e.length;let c=0;for(let r=0;r<n;r++)c+=(e[r]-meanX)*(t[r]-meanY);return r&&n>1&&(n-=1),c/n}function Nc(e,t,r=!0){if(0===e.length)return;return Mc(e,t,r)/($c(e)*$c(t))}function Ic(e,t,r=!1){const n=e.length;if(0!==n){void 0===t&&([e,t]=Ec(e,r)),Ic={},maxValue=e[0]-1;for(let t=0;t<n;t++){const r=e[t];r>maxValue?(maxValue=r,(Ic={})[r]=!0):r===maxValue&&(Ic[r]=!0)}return new Float64Array(Ic.keys())}}function Ec(e,t=!1){const r=e.length;freqeuencies={};for(let t=0;t<r;t++){const r=e[t],n=frequencies[r];frequencies[r]=void 0===n?1:n+1}const n=new Float64Array(frequencies.keys()),c=n.length,o=new Float64Array(c);for(let e=0;e<c;e++)o[e]=frequencies[n[e]];return[n,o]}function Cc(e,t,r=!1){return pr(e,t,r)}function Uc(e,t,r){return e<t||e>r?0:1/(t-r)}function kc(e,t,r){return e<t?0:e>r?1:(e-t)/(r-t)}function Pc(e,t,r){return t+e*(t-r)}function qc(e,t){return t*W(-t*e)}function Rc(e,t){return 1-W(-t*e)}function Xc(e,t){return-J(1-e)/t}Object.freeze(jc),Object.freeze(Oc),Object.freeze(gc),Object.freeze(dc),Object.freeze(vc),Object.freeze(mc),Object.freeze(wc),Object.freeze(hc),Object.freeze(Ac),Object.freeze(yc),Object.freeze(_c),Object.freeze(pc),Object.freeze(Fc),Object.freeze(xc),Object.freeze($c),Object.freeze(Mc),Object.freeze(Nc),Object.freeze(Ic),Object.freeze(Cc),Object.freeze(Ec),Object.freeze(Uc),Object.freeze(kc),Object.freeze(Pc),Object.freeze(qc),Object.freeze(Rc),Object.freeze(Xc);var Vc=Object.freeze({__proto__:null,debug:sc,sum:pc,mean:Fc,variance:xc,sdev:$c,cov:Mc,cor:Nc,get modes(){return Ic},freq:Cc,toFreq:Ec,unifPdf:Uc,unifCdf:kc,unifInvCdf:Pc,expPdf:qc,expCdf:Rc,expInvCdf:Xc});function Tc(e,t=e*E*10){const r=R(e),n=e-r;let c=0,o=1,f=1,u=1,a=c,i=o,s=a/i;for(;C(s-n)>t;)n>s?(c=a,o=i,a+=f,i+=u):(f=a,u=i,a+=c,i+=o),s=a/i;const l=new Int32Array(2);return l[0]=a+i*r,l[1]=i,l}const Gc=Math.cbrt(E);function Sc(e,t){const r=t*(1+Gc),n=t*(1-Gc),c=n-r;return(e(n)-e(r))/c}Object.freeze(Tc),Object.freeze(Sc);var Lc=Object.freeze({__proto__:null,frac:Tc,derivative:Sc});function Dc(e=Oc(1,N)){e=ie(10.23*e,4096e3);const t=function(t){return t=se(.1031*t),t*=t+e,se(t*=t+t)};return t.seed=e,Object.freeze(t)}function Bc(e=Oc(1,N)){e=ie(10.23*e,N);const t=function(t){const r=se(.1031*t[0]),n=se(.1031*t[1]),c=De([r,n,r],[n+e,r+e,r+e]);return se((r+n+2*c)*(r+c))};return t.seed=e,Object.freeze(t)}function Qc(e){return e*e*e*(e*(6*e-15)+10)}function Yc(e=[0,1],t=Oc(1,Number.MAX_SAFE_INTEGER)){const r=Dc(t),n=e[0],c=.5*(n+e[1]),o=2*(c-n),f=function(e){const t=R(e),n=t+1,f=r(t),u=r(n),a=e-t;return c+ae(f*a,u*(a-1),Qc(a))*o};f.seed=t;f.deriv=Object.freeze((function(e){const t=R(e),n=t+1,c=r(t),f=e-t;return(r(n)*(f-1)-c*f)*((u=f)*u*(30+u*(30*u+60)))*o;var u}));return f.grid=Object.freeze((function(e,t,n){const c=R(e),o=R(e+t*n)-c,f=new Float64Array(t),u=e+t*n,a=1e-4*n;let i=e-c,s=0,l=0,b=0,z=r(c),j=n*z;for(let e=0;e<o;e++){l=z,b=j,z=r(e+1),j=z*n,c0=i*l,c1=(i-1)*z;const t=e===o-1?u-maxCellX+a:1+a;for(;i<t;)f[s++]=ae(c0,c1,Qc(i)),c0+=b,c1+=j;i-=1}return f})),Object.freeze(f)}function Hc(e){return e*e*e*(e*(6*e-15)+10)}Object.freeze(Dc),Object.freeze(Bc),Object.freeze(Yc);const Wc=function(e,t,r,n,c,o){const f=Hc(c),u=Hc(o),a=ae(e,t,u),i=ae(r,n,u);return ae(a,i,f)};function Jc(e,t,r){return n("unif(?a, ?b, ?count)",arguments),h("a"),h("b"),p("count"),c(),jc(e,t,r)}function Kc(e,t,r){return n("int(a, b, ?count)",arguments),h("a"),h("b"),p("count"),c(),Oc(e,t,r)}function Zc(e,t,r){return n("norm(?mean, ?sd, ?count)",arguments),h("mean"),h("sd"),_("sd"),p("count"),c(),gc(e,t,r)}function eo(e,t){return n("exp(?lambda, ?count)",arguments),h("lambda"),p("count"),c(),dc(e,t)}function to(e,t,r){return n("MCG(?a, ?b, ?seed)",arguments),a(e,signature),a(t,signature),O(r),vc(e,t,r)}function ro(e=0,t=1,r=Oc(1,4294967295)){return n("Xorshift32(?a, ?b, ?seed)",arguments),a(e,signature),a(t,signature),O(r),mc(e,t,r)}function no(e=0,t=1,r=Oc(1,4294967295)){return n("RU(?mean, ?sd, ?seed)",arguments),a(e,signature),a(t,signature),b(t,signature),O(r),wc(e,t,r)}const co=ro,oo=no,fo=function(e,t,r=Oc(1,4294967295)){return n("Int(a, b, ?seed)",arguments),a(e,signature),a(t,signature),O(r),Ac(e,t,r)};function uo(e=1,t=Kc(1,4294967295)){}Object.freeze(Jc),Object.freeze(Kc),Object.freeze(Zc),Object.freeze(eo),Object.freeze(to),Object.freeze(ro),Object.freeze(no),Object.freeze(co),Object.freeze(fo),Object.freeze(oo),Object.freeze(uo);var ao=Object.freeze({__proto__:null,unif:Jc,int:Kc,norm:Zc,exp:eo,MCG:to,Xorshift32:ro,RU:no,Unif:co,Int:fo,Norm:oo,Exp:uo}),io=Object.freeze({__proto__:null,debug:ao,unif:jc,int:Oc,norm:gc,exp:dc,MCG:vc,Xorshift32:mc,RU:wc,Unif:hc,Int:Ac,Norm:yc,Exp:_c,Float1to1:Dc,Float2to1:Bc,Perlin1D:Yc,Perlin2D:function(e=[0,1],t=Oc(1,1e3)){const r=Bc(t);function n(e,t){const n=2*M*r([e,t]);return[T(n),X(n)]}const c=e[0],o=(e[1]-c)/2,f=c+o,u=o/(.5*B(2)),a=function(e,t){const r=R(e),c=R(t),o=r+1,a=c+1,i=e-r,s=t-c,l=n(r,c),b=n(r,a),z=n(o,c),j=n(o,a),O=Le(l,[i,s]),g=Le(b,[i,s-1]),d=Le(z,[i-1,s]),v=Le(j,[i-1,s-1]),m=Wc(O,g,d,v,i,s);return f+m*u};return a.deriv=Object.freeze((function(e,t){const r=R(e),c=R(t),o=r+1,f=c+1,a=e-r,i=t-c,s=n(r,c),l=n(r,f),b=n(o,c),z=n(o,f),j=Le(s,[a,i]),O=Le(l,[a,i-1]),g=Le(b,[a-1,i]),d=Le(z,[a-1,i-1]),v=Hc(i),m=ae(j,O,v),w=ae(g,d,v),h=30*a*a*(a*(a-2)+1),y=30*i*i*(i*(i-2)+1),A=He(He(s,ut(Ze(b,s),h)),[h*(g-j),0]),_=He(He(l,ut(Ze(z,l),h)),[h*(d-O),0]);let p=He(He(A,ut(Ze(_,A),y)),[0,y*(w-m)]);return p=ut(p,u),p})),a.grid=Object.freeze((function(e,t,r,c,o,a){const i=1e-5*o,s=1e-5*(a=null==a?o:a),l=e+(r-1)*o,b=t+(c-1)*a,z=R(e),j=R(t),O=q(l)-1,g=q(b)-1,d=1+g-j,v=1+O-z;let m,w,h,y,A,_,p,F,x,$,M,N,I,E,C,U,P,X,V,T,G,S,L,D,B,Q=new Float32Array(r*c),Y=0,H=e-z,W=t-j,J=Array(d+1),K=Array(d+1);for(L=0;L<=d;L++)[m,w]=n(z,j+L),K[L]=[m,w,m*o,w*a];for(p=z,h=H,S=0;S<v;S++){for(Y=k((p+h-e)/o),F=j,y=W,A=S===v-1?l-O+i:1+i,G=J,J=K,K=G,[m,w]=n(p,F),K[0]=[m,w,m*o,w*a],L=0;L<d;L++){for(D=L+1,h=H,_=D===d?b-g+s:1+s,I=J[L],E=J[D],C=K[L],[m,w]=n(p,F+D),U=[m,w,m*o,w*a],K[D]=U,P=Le([h,y],I),X=Le([h,y-1],E),V=Le([h-1,y],C),T=Le([h-1,y-1],U);y<=_;){for(B=Y,h=H,x=P,$=X,M=V,N=T;h<=A;)Q[B++]=f+u*Wc(x,$,M,N,h,y),h+=o,x+=I[2],$+=E[2],M+=C[2],N+=U[2];y+=a,Y+=r,P+=I[3],X+=E[3],V+=C[3],T+=U[3]}F++,y--}H=--h,p++}return Q.nrows=c,Q.ncols=r,Q})),a.fbm=Object.freeze((function(e,t,r=5,n=1.5,c=.7){let o=0,f=1,u=1;for(;r--;)o+=f*a(e,t),u+=f,f*=c,e=e*n+.3,t=t*n+.3;return o/=u,o})),a.seed=t,a.dimension=2,a}});return e.VERSION="dev-1.0.0",e.array=ic,e.complex=ec,e.integer=Te,e.matrix=en,e.numerical=Lc,e.random=io,e.standard=he,e.statistics=Vc,e.vector=br,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
