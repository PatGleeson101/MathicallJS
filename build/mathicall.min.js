var Mathicall=function(e){"use strict";const t=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];function r(e,t,r){if(e.constructor!==Number)throw`${r}: ${t} must be of type Number.`;if(!isFinite(e))throw`${r}: ${t} cannot be NaN or Infinity.`}function n(e,r,n){if(!t.includes(e.constructor)){if(Array.isArray(e)){const t=e.length;0===t&&console.warn(`${n}: ${r} is empty.`);for(let c=0;c<t;c++){e[c];if(e.constructor!==Number)throw`${n}: ${r} must an array of Numbers.`;if(!isFinite(e))throw`${n}: ${r} contains NaN or Infinity.`}}throw`${n}: ${r} must be an Array or TypedArray.`}}function c(e,t,r){if(!Number.isInteger(e))throw`${r}: ${t} must be an integer of type Number.`}function o(e,t,n){if(r(e,t,n),e<=0)throw`${n}: ${t} must be positive.`}function f(e,t,n){if(r(e,t,n),e<0)throw`${n}: ${t} must be non-negative.`}function a(e,t,r){if(!0!==e&&!1!==e)throw`${r}: ${t} must be a boolean value.`}function i(e,t,r,n){if(t){const t=e.length;if(e[t-1]>e[0]){for(let c=1;c<t;c++)if(e[c]<e[c-1])throw`${n}: sorted set to true but ${r} is unsorted`}else for(let c=1;c<t;c++)if(e[c]>e[c-1])throw`${n}: sorted set to true but ${r} is unsorted`}}function l(e,t,r){n(e,t,r);const c=e.length;if(c<2)throw`${r}: ${t} must have two components.`;c>2&&console.warn(`${r}: ${t} contains additional values which will be ignored.`),e[0]<0&&console.warn(`${r}: ${t} expressed with negative magnitude.`)}function s(e,t,r){n(e,t,r);const c=e.length;if(c<2)throw`${r}: ${t} must have two components.`;c>2&&console.warn(`${r}: ${t} contains additional values which will be ignored.`)}function z(e,t,r){c(e,t,r),o(e,t,r)}function b(e,t,r){n(e,t,r),z(e.rows,`${t}.rows`,r),z(e.cols,`${t}.cols`,r)}function O(e,t){e===h&&console.warn(`${t} overflow: returned Number.MAX_VALUE`)}function j(e,t){e>w&&console.warn(`${t} integer overflow: returned value is approximate.`)}Object.freeze(r),Object.freeze(n),Object.freeze(c),Object.freeze(o),Object.freeze(f),Object.freeze((function(e,t,r){n(e,t,r)})),Object.freeze((function(e,t,r){n(e,t,r),e[0]<0&&console.warn(`${r}: ${t} expressed with negative magnitude.`)})),Object.freeze(a),Object.freeze(i),Object.freeze(l),Object.freeze(s),Object.freeze(b),Object.freeze(z),Object.freeze(O),Object.freeze(j);const m=Math.E,v=Math.LN2,g=Math.SQRT2,d=Math.PI,w=Number.MAX_SAFE_INTEGER,h=Number.MAX_VALUE,_=Number.EPSILON,y=Math.abs,p=Math.sign,A=Math.round,F=Math.trunc,x=Math.ceil,$=Math.floor,M=Math.sin,N=Math.asin,I=Math.cos,k=Math.acos,E=Math.tan,q=Math.atan,P=Math.atan2,U=Math.sqrt,V=Math.cbrt,L=Math.hypot,T=Math.pow,R=Math.exp,S=Math.log,X=Math.log2,C=Math.log10,D=Math.max,G=Math.min,B=Math.random,Q=180/d,Y=1/Q,H=2*d,W=.5*d,J=1/d;function K(e,t,r){return e+(t-e)*r}function Z(e,t){return(e%t+t)%t}function ee(e){return e-F(e)}function te(e){return e*Q}function re(e){return e*Y}function ne(e,t,r){const n=r[0],c=t[0];return n+(r[1]-n)*(e-c)/(t[1]-c)}function ce(e,t,n){const c="lerp(x, y, r)";return r(e,"x",c),r(t,"y",c),r(n,"r",c),K(e,t,n)}function oe(e,t){const n="mod(x, m)";return r(e,"x",n),r(t,"m",n),Z(e,t)}function fe(e){return r(e,"x","fract(x)"),ee(e)}function ue(e){return r(e,"radians","deg(radians)"),te(e)}function ae(e){return r(e,"degrees","rad(degrees)"),re(e)}function ie(e,t,n){return r(e,"x","linmap(x, domain, range)"),ne(e,t,n)}Object.freeze(K),Object.freeze(Z),Object.freeze(ee),Object.freeze(te),Object.freeze(re),Object.freeze(ne),Object.freeze(ce),Object.freeze(oe),Object.freeze(fe),Object.freeze(ue),Object.freeze(ae),Object.freeze(ie);var le=Object.freeze({__proto__:null,lerp:ce,mod:oe,fract:fe,deg:ue,rad:ae,linmap:ie}),se=Object.freeze({__proto__:null,debug:le,E:m,LN2:v,SQRT2:g,PI:d,MAX_SAFE_INTEGER:w,MAX_VALUE:h,EPSILON:_,abs:y,sign:p,round:A,trunc:F,ceil:x,floor:$,sin:M,asin:N,cos:I,acos:k,tan:E,atan:q,atan2:P,sqrt:U,cbrt:V,hypot:L,pow:T,exp:R,ln:S,log2:X,log10:C,max:D,min:G,random:B,RAD_TO_DEG:Q,DEG_TO_RAD:Y,TWO_PI:H,HALF_PI:W,INV_PI:J,lerp:K,mod:Z,fract:ee,deg:te,rad:re,linmap:ne});function ze(e=170){const t=e+1,r=new Float64Array(t);r[0]=1;for(let e=1;e<t;e++)r[e]=e*r[e-1];return r}function be(e=30){const t=new Float64Array(.5*(e+1)*(e+2));let r=-1;for(let n=0;n<=e;n++){t[r++]=1;for(let e=1;e<n;e++)t[r]=t[r-n-1]+t[r-n],r++;t[r++]=1}return t}const Oe=ze();let je,me;function ve(e){je=e,me=be(e)}function ge(e){if(!(e<0))return e>170?h:Oe[e]}function de(e,t){if(t>e||e<0||t<0)return 0;if(e<=je)return me[.5*e*(e+1)+t];const r=G(t,e-t);if(r>514)return h;const n=e-r;let c=1,o=1;for(;o<=r;)c*=(n+o)/o++;return c}function we(e,t){if(t>e||e<0||t<0)return 0;if(t>170)return h;if(t=e-t,e<171)return A(Oe[e]/Oe[t]);let r=1;for(t<160&&(r=A(Oe[170]/Oe[t]),t=170);t<e;)r*=++t;return r}function he(e,t){if(e=y(e),t=y(t),0===e)return t;if(0===t)return e;if(e<4294967296&&t<4294967296){let r=0;for(;0==(1&(e|t));)e>>>=1,t>>>=1,r++;for(;0==(1&e);)e>>>=1;for(;0!==t;){for(;0==(1&t);)t>>>=1;if(e>t){const r=e;e=t,t=r}t-=e}return e<<r}for(;e!==t;)e>t?e-=t:t-=e;return e}function _e(e,t){return 0===e||0===t?0:y(e/he(e,t)*t)}function ye(e,t,r){if(t=y(t),1===r)return 0;{let n=1;for(e%=r;t>0;)1&t&&(n=n*e%r),t>>=1,e=e**2%r;return n}}function pe(e){const t="factorial(n)";c(e,"n",t),f(e,"n",t);const r=ge(e);return O(r,t),j(r,t),r}function Ae(e,t){const r="choose(n, r)";c(e,"n",r),c(t,"r",r);const n=de(e,t);return O(n,r),j(n,r),n}function Fe(e,t){const r="permute(n, r)";c(e,"n",r),c(t,"r",r);const n=we(e,t);return O(n,r),j(n,r),n}function xe(e,t){const r="gcd(a, b)";return c(e,"a",r),c(t,"b",r),he(e,t)}function $e(e,t){const r="lcm(a, b)";return c(e,"a",r),c(t,"b",r),_e(e,t)}function Me(e,t,r){const n="mpow(base, exp, m)";return c(e,"base",n),c(t,"exp",n),f(t,"exp",n),c(r,"m",n),ye(e,t,r)}ve(30),Object.freeze(ze),Object.freeze(be),Object.freeze(ve),Object.freeze(ge),Object.freeze(de),Object.freeze(we),Object.freeze(he),Object.freeze(_e),Object.freeze(ye),Object.freeze(pe),Object.freeze(Ae),Object.freeze(Fe),Object.freeze(xe),Object.freeze($e),Object.freeze(Me);var Ne=Object.freeze({__proto__:null,factorial:pe,choose:Ae,permute:Fe,gcd:xe,lcm:$e,mpow:Me}),Ie=Object.freeze({__proto__:null,debug:Ne,computeFactorials:ze,computeBinomials:be,precomputeBinomials:ve,factorial:ge,choose:de,permute:we,gcd:he,lcm:_e,mpow:ye});function ke(e,t){let r=0;const n=e.length;for(let c=0;c<n;c++)r+=e[c]*t[c];return r}function Ee(e,t){return e[0]*t[0]+e[1]*t[1]}function qe(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Pe(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ue(e,t,r=new Float64Array(3)){return r[0]=e[1]*t[2]-e[2]*t[1],r[1]=e[2]*t[0]-e[0]*t[2],r[2]=e[0]*t[1]-e[1]*t[0],r}function Ve(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]+t[c];return r}function Le(e,t,r=new Float64Array(2)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function Te(e,t,r=new Float64Array(3)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function Re(e,t,r=new Float64Array(4)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function Se(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]-t[c];return r}function Xe(e,t,r=new Float64Array(2)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}function Ce(e,t,r=new Float64Array(3)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function De(e,t,r=new Float64Array(4)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function Ge(e){return L(...e)}function Be(e){return L(e[0],e[1])}function Qe(e){return L(e[0],e[1],e[2])}function Ye(e){return L(e[0],e[1],e[2],e[3])}function He(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]*t;return r}function We(e,t,r=new Float64Array(2)){return r[0]=e[0]*t,r[1]=e[1]*t,r}function Je(e,t,r=new Float64Array(3)){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function Ke(e,t,r=new Float64Array(4)){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function Ze(e,t){return scale(e,1/Ge(e),t)}function et(e,t){return scale2(e,1/Be(e),t)}function tt(e,t){return scale3(e,1/Qe(e),t)}function rt(e,t){return scale4(e,1/Ye(e),t)}function nt(e,t){return k(ke(e,t)/(Ge(e)*Ge(t)))}function ct(e,t){return k(Ee(e,t)/(Be(e)*Be(t)))}function ot(e,t){return k(qe(e,t)/(Qe(e)*Qe(t)))}function ft(e,t){return k(Pe(e,t)/(Ye(e)*Ye(t)))}function ut(e,t=new Float64Array(e.length)){const r=e.length;for(let n=0;n<r;n++)t[n]=ee(e[n]);return t}function at(e,t=new Float64Array(2)){return t[0]=ee(e[0]),t[1]=ee(e[1]),t}function it(e,t=new Float64Array(3)){return t[0]=ee(e[0]),t[1]=ee(e[1]),t[2]=ee(e[2]),t}function lt(e,t=new Float64Array(4)){return t[0]=ee(e[0]),t[1]=ee(e[1]),t[2]=ee(e[2]),t[3]=ee(e[3]),t}function st(e,t=new Float64Array(2)){t[0]=Be(e),t[1]=P(e[1],e[0])+d}function zt(e,t){const r="dot(vec1, vec2)";return n(e,"vec1",r),n(t,"vec2",r),ke(e,t)}function bt(e,t){const r="dot2(vec1, vec2)";return n(e,"vec1",r),n(t,"vec2",r),Ee(e,t)}function Ot(e,t){const r="dot3(vec1, vec2)";return n(e,"vec1",r),n(t,"vec2",r),qe(e,t)}function jt(e,t){const r="dot4(vec1, vec2)";return n(e,"vec1",r),n(t,"vec2",r),Pe(e,t)}function mt(e,t,r){const c="cross3(vec1, vec2, ?target)";return n(e,"vec1",c),n(t,"vec2",c),Ue(e,t,r)}function vt(e,t,r){const c="add(vec1, vec2, ?target)";return n(e,"vec1",c),n(t,"vec2",c),Ve(e,t,r)}function gt(e,t,r){const c="add2(vec1, vec2, ?target)";return n(e,"vec1",c),n(t,"vec2",c),Le(e,t,r)}function dt(e,t,r){const c="add3(vec1, vec2, ?target)";return n(e,"vec1",c),n(t,"vec2",c),Te(e,t,r)}function wt(e,t,r){const c="add4(vec1, vec2, ?target)";return n(e,"vec1",c),n(t,"vec2",c),Re(e,t,r)}function ht(e,t,r){const c="sub(vec1, vec2, ?target)";return n(e,"vec1",c),n(t,"vec2",c),Se(e,t,r)}function _t(e,t,r){const c="sub2(vec1, vec2, ?target)";return n(e,"vec1",c),n(t,"vec2",c),Xe(e,t,r)}function yt(e,t,r){const c="sub3(vec1, vec2, ?target)";return n(e,"vec1",c),n(t,"vec2",c),Ce(e,t,r)}function pt(e,t,r){const c="sub4(vec1, vec2, ?target)";return n(e,"vec1",c),n(t,"vec2",c),De(e,t,r)}function At(e){return n(e,"vec","mag(vec)"),Ge(e)}function Ft(e){return n(e,"vec","mag2(vec)"),Be(e)}function xt(e){return n(e,"vec","mag3(vec)"),Qe(e)}function $t(e){return n(e,"vec","mag4(vec)"),Ye(e)}function Mt(e,t,c){const o="smult(vec, k, ?target)";return n(e,"vec",o),r(t,"k",o),He(e,t,c)}function Nt(e,t,c){const o="smult2(vec, k, ?target)";return n(e,"vec",o),r(t,"k",o),We(e,t,c)}function It(e,t,c){const o="smult3(vec, k, ?target)";return n(e,"vec",o),r(t,"k",o),Je(e,t,c)}function kt(e,t,c){const o="smult4(vec, k, ?target)";return n(e,"vec",o),r(t,"k",o),Ke(e,t,c)}function Et(e,t){return n(e,"vec","normalize(vec, ?target)"),Ze(e,t)}function qt(e,t){return n(e,"vec","normalize2(vec, ?target)"),et(e,t)}function Pt(e,t){return n(e,"vec","normalize3(vec, ?target)"),tt(e,t)}function Ut(e,t){return n(e,"vec","normalize4(vec, ?target)"),rt(e,t)}function Vt(e,t){const r="angle(vec1, vec2)";return n(e,"vec1",r),n(t,"vec2",r),nt(e,t)}function Lt(e,t){const r="angle2(vec1, vec2)";return n(e,"vec1",r),n(t,"vec2",r),ct(e,t)}function Tt(e,t){const r="angle3(vec1, vec2)";return n(e,"vec1",r),n(t,"vec2",r),ot(e,t)}function Rt(e,t){const r="angle4(vec1, vec2)";return n(e,"vec1",r),n(t,"vec2",r),ft(e,t)}function St(e,t){return n(e,"vec","fract(vec, ?target)"),ut(e,t)}function Xt(e,t){return n(e,"vec","fract2(vec, ?target)"),at(e,t)}function Ct(e,t){return n(e,"vec","fract3(vec, ?target)"),it(e,t)}function Dt(e,t){return n(e,"vec","fract4(vec, ?target)"),lt(e,t)}function Gt(e,t){return n(e,"vec","polar2(vec, ?target)"),st(e,t)}Object.freeze(ke),Object.freeze(Ee),Object.freeze(qe),Object.freeze(Pe),Object.freeze(Ue),Object.freeze(Ve),Object.freeze(Le),Object.freeze(Te),Object.freeze(Re),Object.freeze(Se),Object.freeze(Xe),Object.freeze(Ce),Object.freeze(De),Object.freeze(Ge),Object.freeze(Be),Object.freeze(Qe),Object.freeze(Ye),Object.freeze(He),Object.freeze(We),Object.freeze(Je),Object.freeze(Ke),Object.freeze(Ze),Object.freeze(et),Object.freeze(tt),Object.freeze(rt),Object.freeze(nt),Object.freeze(ct),Object.freeze(ot),Object.freeze(ft),Object.freeze(ut),Object.freeze(at),Object.freeze(it),Object.freeze(lt),Object.freeze(st),Object.freeze(zt),Object.freeze(bt),Object.freeze(Ot),Object.freeze(jt),Object.freeze(mt),Object.freeze(vt),Object.freeze(gt),Object.freeze(dt),Object.freeze(wt),Object.freeze(ht),Object.freeze(_t),Object.freeze(yt),Object.freeze(pt),Object.freeze(At),Object.freeze(Ft),Object.freeze(xt),Object.freeze($t),Object.freeze(Mt),Object.freeze(Nt),Object.freeze(It),Object.freeze(kt),Object.freeze(Et),Object.freeze(qt),Object.freeze(Pt),Object.freeze(Ut),Object.freeze(Vt),Object.freeze(Lt),Object.freeze(Tt),Object.freeze(Rt),Object.freeze(St),Object.freeze(Xt),Object.freeze(Ct),Object.freeze(Dt),Object.freeze(Gt);var Bt=Object.freeze({__proto__:null,dot:zt,dot2:bt,dot3:Ot,dot4:jt,cross3:mt,add:vt,add2:gt,add3:dt,add4:wt,sub:ht,sub2:_t,sub3:yt,sub4:pt,mag:At,mag2:Ft,mag3:xt,mag4:$t,smult:Mt,smult2:Nt,smult3:It,smult4:kt,normalize:Et,normalize2:qt,normalize3:Pt,normalize4:Ut,angle:Vt,angle2:Lt,angle3:Tt,angle4:Rt,fract:St,fract2:Xt,fract3:Ct,fract4:Dt,polar2:Gt}),Qt=Object.freeze({__proto__:null,debug:Bt,dot:ke,dot2:Ee,dot3:qe,dot4:Pe,cross3:Ue,add:Ve,add2:Le,add3:Te,add4:Re,sub:Se,sub2:Xe,sub3:Ce,sub4:De,mag:Ge,mag2:Be,mag3:Qe,mag4:Ye,smult:He,smult2:We,smult3:Je,smult4:Ke,normalize:Ze,normalize2:et,normalize3:tt,normalize4:rt,angle:nt,angle2:ct,angle3:ot,angle4:ft,fract:ut,fract2:at,fract3:it,fract4:lt,polar2:st});function Yt(e,t){return e[0]*t[0]*I(e[1]-t[1])}function Ht(e){return y(e[0])}function Wt(e,t,r=new Float64Array(2)){r[0]=e[0]*t,r[1]=Z(e[1],H)}function Jt(e,t=new Float64Array(2)){t[0]=1,t[1]=Z(e[1],H)}function Kt(e,t=new Float64Array(2)){const r=e[0],n=e[1];return t[0]=r*I(n),t[1]=r*M(n),t}Object.freeze(Yt),Object.freeze(Ht),Object.freeze(Wt),Object.freeze(Jt),Object.freeze(Kt);var Zt=Object.freeze({__proto__:null,dot2:Yt,mag:Ht,smult2:Wt,normalize2:Jt,rect2:Kt}),er=Object.freeze({__proto__:null,rect:Qt,polar:Zt});function tr(e,t){const r=new Float64Array(e*t);return r.nrows=e,r.ncols=t,r}function rr(e,t,r){const n=new Float64Array(e*t);return n.fill(r),n.nrows=e,n.ncols=t,n}function nr(e){const t=e*e,r=e+1,n=new Float64Array(t);for(let e=0;e<t;e+=r)n[e]=1;return n.nrows=e,n.ncols=e,n}function cr(e,t=new Float64Array(e.length*e[0].length)){const r=e.length,n=e[0].length;for(let c=0;c<r;c++)for(let o=0;o<n;o++)t[c*r+o]=e[c][o];return t.rows=r,t.cols=n,t}function or(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]*t;return r.nrows=e.nrows,r.ncols=e.ncols,r}function fr(e,t=new Float64Array(4)){t[0]=e[0],t[3]=e[3];const r=e[1];return t[1]=e[2],t[2]=r,t.nrows=2,t.ncols=2,t}function ur(e,t=new Float64Array(9)){t[0]=e[0],t[4]=e[4],t[8]=e[8];let r=e[1];return t[1]=e[3],t[3]=r,r=e[2],t[2]=e[6],t[6]=r,r=e[5],t[5]=e[7],t[7]=r,t.nrows=3,t.ncols=3,t}function ar(e,t=new Float64Array(16)){t[0]=e[0],t[5]=e[5],t[10]=e[10],t[15]=e[15];let r=e[1];return t[1]=e[4],t[4]=r,r=e[2],t[2]=e[8],t[8]=r,r=e[3],t[3]=e[12],t[12]=r,r=e[6],t[6]=e[9],t[9]=r,r=e[7],t[7]=e[13],t[13]=r,r=e[11],t[11]=e[14],t[14]=r,t.nrows=4,t.ncols=4,t}function ir(e,t){const r=e.nrows,n=e.ncols,c=(t.nrows,t.ncols),o=new Float64Array(r*c);o.nrows=r,o.ncols=c;let f=0,u=0,a=0;for(let i=0;i<r;i++)for(let r=0;r<c;r+=1){f=0,u=n*i,a=r;for(let r=0;r<n;r+=1)f+=e[u]*t[a],u+=1,a+=c;o[i*c+r]=f}return o}function lr(e){return[e.rnows,e.ncols]}function sr(e){return e[0]*e[3]-e[1]*e[2]}function zr(e,t=new Float64Array(4)){const r=e[0],n=e[1],c=e[2],o=e[3],f=r*o-n*c;if(0===f)return;const u=1/f;return t[0]=o*u,t[3]=r*u,t[1]=-n*u,t[2]=-c*u,t.nrows=2,t.ncols=2,t}function br(e,t){const r=t.ncols,n=e.length;if(n!==t.nrows)return;const c=new Float64Array(r);let o=0;for(let f=0;f<n;f++){vi=e[f];for(let e=0;e<r;e++)c[e]+=vi*t[o++]}return c}function Or(e,t){const r=new Float64Array(2),n=(e[0],e[1]);return r[0]=n*t[0]+v2*t[2],r[0]=n*t[1]+v2*t[3],r}function jr(e,t){e.nrows;const r=e.ncols,n=e.length;if(t.length!==r)return;const c=new Float64Array(r);for(let o=0;o<r;o++){vj=t[o];let f=0;for(let t=o;t<n;t+=r)c[f++]+=vj*e[t]}return c}function mr(e,t){const r="zeros(m, n)";return z(e,"m",r),z(t,"n",r),tr(e,t)}function vr(e,t,n){const c="constant(m, n, value)";return z(e,"m",c),z(t,"n",c),r(n,"value",c),rr(e,t,n)}function gr(e){return z(e,"m","identity(m)"),nr(e)}function dr(e,t){return cr(e,t)}function wr(e,t,n){const c="smult(mat, k, target)";return b(e,"mat",c),r(t,"k",c),or(e,t,n)}function hr(e,t){return b(e,"mat","transpose2(mat, target)"),fr(e,t)}function _r(e,t){return b(e,"mat","transpose3(mat, target)"),ur(e,t)}function yr(e,t){return b(e,"mat","transpose4(mat, target)"),ar(e,t)}function pr(e,t){const r="mmult(mat1, mat2)";return b(e,"mat1",r),b(t,"mat2",r),ir(e,t)}function Ar(e){return b(e,"mat","size(mat)"),lr(e)}function Fr(e){return b(e,"mat","det2(mat)"),sr(e)}function xr(e,t){return b(e,"mat","inverse2(mat, target)"),zr(e,t)}Object.freeze(tr),Object.freeze(rr),Object.freeze(nr),Object.freeze(cr),Object.freeze(or),Object.freeze(fr),Object.freeze(ur),Object.freeze(ar),Object.freeze(ir),Object.freeze(lr),Object.freeze(sr),Object.freeze(zr),Object.freeze(br),Object.freeze(Or),Object.freeze(jr),Object.freeze(mr),Object.freeze(vr),Object.freeze(gr),Object.freeze(dr),Object.freeze(wr),Object.freeze(hr),Object.freeze(_r),Object.freeze(yr),Object.freeze(pr),Object.freeze(Ar),Object.freeze(Fr),Object.freeze(xr);var $r=Object.freeze({__proto__:null,zeros:mr,constant:vr,identity:gr,flatten:dr,smult:wr,transpose2:hr,transpose3:_r,transpose4:yr,mmult:pr,size:Ar,det2:Fr,inverse2:xr}),Mr=Object.freeze({__proto__:null,debug:$r,zeros:tr,constant:rr,identity:nr,flatten:cr,smult:or,transpose2:fr,transpose3:ur,transpose4:ar,mmult:ir,size:lr,det2:sr,inverse2:zr,vmult:br,vmult2x2:Or,multv:jr});function Nr(e,t=new Float64Array(2)){return t[0]=e[0],t[1]=-e[1],t}function Ir(e){return e[0]}function kr(e){return e[1]}function Er(e){return P(e[1],e[0])}function qr(e){return L(e[0],e[1])}function Pr(e,t,r=new Float64Array(2)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function Ur(e,t,r=new Float64Array(2)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}function Vr(e,t,r=new Float64Array(2)){const n=e[0],c=e[1],o=t[0],f=t[1];return r[0]=n*o-c*f,r[1]=n*f-o*c,r}function Lr(e,t,r=new Float64Array(2)){return r[0]=e[0]*t,r[1]=e[1]*t,r}function Tr(e,t,r=new Float64Array(2)){const n=e[0],c=e[1],o=t[0],f=t[1],u=1/(o*o+f*f);return r[0]=(n*o+c*f)*u,r[1]=(-n*f-o*c)*u,r}function Rr(e,t=new Float64Array(2)){e[0],e[1];const r=1/(re2*re2+im2*im2);return t[0]=(re1*re2+im1*im2)*r,t[1]=(-re1*im2-re2*im1)*r,t}function Sr(e,t=new Float64Array(2)){const r=e[0],n=e[1],c=L(r,n);return t[0]=c,t[1]=P(n,r),t}function Xr(e,t){return s(e,"z","conj(z, ?target)"),Nr(e,t)}function Cr(e){return s(e,"z","real(z)"),Ir(e)}function Dr(e){return s(e,"z","imag(z)"),kr(e)}function Gr(e){return s(e,"z","arg(z)"),Er(e)}function Br(e){return s(e,"z","abs(z)"),qr(e)}function Qr(e,t,r){const n="add(z1, z2, ?target)";return s(e,"z1",n),s(t,"z2",n),Pr(e,t,r)}function Yr(e,t,r){const n="sub(z1, z2, ?target)";return s(e,"z1",n),s(t,"z2",n),Ur(e,t,r)}function Hr(e,t,r){const n="cmult(z1, z2, ?target)";return s(e,"z1",n),s(t,"z2",n),Vr(e,t,r)}function Wr(e,t,n){const c="smult(z, k, ?target)";return s(e,"z",c),r(t,"k",c),Lr(e,t,n)}function Jr(e,t,r){const n="div(z1, z2, ?target)";return s(e,"z1",n),s(t,"z2",n),Tr(e,t,r)}function Kr(e,t){return s(e,"z","inverse(z, ?target)"),Rr(e,t)}function Zr(e,t){return s(e,"z","inverse(z, ?target)"),Rr(e,t)}Object.freeze(Nr),Object.freeze(Ir),Object.freeze(kr),Object.freeze(Er),Object.freeze(qr),Object.freeze(Pr),Object.freeze(Ur),Object.freeze(Vr),Object.freeze(Lr),Object.freeze(Tr),Object.freeze(Rr),Object.freeze(Sr),Object.freeze(Xr),Object.freeze(Cr),Object.freeze(Dr),Object.freeze(Gr),Object.freeze(Br),Object.freeze(Qr),Object.freeze(Yr),Object.freeze(Hr),Object.freeze(Wr),Object.freeze(Jr),Object.freeze(Kr),Object.freeze(Zr);var en=Object.freeze({__proto__:null,conj:Xr,real:Cr,imag:Dr,arg:Gr,abs:Br,add:Qr,sub:Yr,cmult:Hr,smult:Wr,div:Jr,inverse:Kr,polar:Zr}),tn=Object.freeze({__proto__:null,debug:en,conj:Nr,real:Ir,imag:kr,arg:Er,abs:qr,add:Pr,sub:Ur,cmult:Vr,smult:Lr,div:Tr,inverse:Rr,polar:Sr});function rn(e){return(e%=H)>d?e-H:e<-d?e+H:e}function nn(e,t=new Float64Array(2)){const r=e[0],n=e[1];return r<0?(t[0]=-r,t[1]=-rn(n+d)):(t[0]=r,t[1]=-rn(n)),t}function cn(e){return e[0]*I(e[1])}function on(e){return e[0]*M(e[1])}function fn(e){return rn(e[1])}function un(e){return y(e[0])}function an(e,t,r=new Float64Array(2)){const n=e[0]*t,c=e[1];return n<0?(r[0]=-n,r[1]=rn(c+d)):(r[0]=n,r[1]=rn(c)),r}function ln(e,t,r=new Float64Array(2)){const n=e[0]*t[0],c=e[1]+t[1];return n<0?(r[0]=-n,r[1]=rn(c+d)):(r[0]=n,r[1]=rn(c)),r}function sn(e,t,r=new Float64Array(2)){const n=t[0];if(0===n)return;const c=e[0]/n,o=e[1]-t[1];return c<0?(r[0]=-c,r[1]=rn(o+d)):(r[0]=c,r[1]=rn(o)),r}function zn(e,t,r=new Float64Array(2)){const n=e[0],c=e[1];return n<0?(r[0]=T(-n,t),r[1]=rn(t*(c+d))):(r[0]=T(n,t),r[1]=rn(t*c)),r}function bn(e,t=new Float64Array(2)){const r=e[0];if(0===r)return;const n=e[1];return r<0?(t[0]=-1/r,t[1]=rn(-n-d)):(t[0]=1/r,t[1]=rn(-n)),t}function On(e,t=new Float64Array(2)){const r=e[0],n=e[1];return t[0]=r*I(n),t[1]=r*M(n),t}function jn(e,t){return l(e,"z","conj(z, ?target)"),nn(e,t)}function mn(e){return l(e,"z","real(z)"),cn(e)}function vn(e){return l(e,"z","imag(z)"),on(e)}function gn(e){return l(e,"z","arg(z)"),fn(e)}function dn(e){return l(e,"z","abs(z)"),un(e)}function wn(e,t,n){const c="smult(z, k, ?target)";return l(e,"z",c),r(t,"k",c),an(e,t,n)}function hn(e,t,r){const n="cmult(z1, z2, ?target)";return l(e,"z1",n),l(t,"z2",n),ln(e,t,r)}function _n(e,t,r){const n="div(z1, z2, ?target)";return l(e,"z1",n),l(t,"z2",n),sn(e,t,r)}function yn(e,t,n){const c="pow(z, n, ?target)";return l(e,"z",c),r(t,"n",c),zn(e,t,n)}function pn(e,t){return l(e,"z","inverse(z, ?target)"),bn(e,t)}function An(e,t){return l(e,"z","rect(z, ?target)"),On(e,t)}Object.freeze(nn),Object.freeze(cn),Object.freeze(on),Object.freeze(fn),Object.freeze(un),Object.freeze(an),Object.freeze(ln),Object.freeze(sn),Object.freeze(zn),Object.freeze(bn),Object.freeze(On),Object.freeze(jn),Object.freeze(mn),Object.freeze(vn),Object.freeze(gn),Object.freeze(dn),Object.freeze(wn),Object.freeze(hn),Object.freeze(_n),Object.freeze(yn),Object.freeze(pn),Object.freeze(An);var Fn=Object.freeze({__proto__:null,conj:jn,real:mn,imag:vn,arg:gn,abs:dn,smult:wn,cmult:hn,div:_n,pow:yn,inverse:pn,rect:An}),xn=Object.freeze({__proto__:null,debug:Fn,conj:nn,real:cn,imag:on,arg:fn,abs:un,smult:an,cmult:ln,div:sn,pow:zn,inverse:bn,rect:On}),$n=Object.freeze({__proto__:null,rect:tn,polar:xn});const Mn=64;function Nn(e){const t=e.length;let r=0;for(let n=0;n<t;n++)r+=e[n];return r}function In(e,t=!1){const r=e.length;if(t)return G(e[0],e[r-1]);let n=e[0],c=0;for(let t=1;t<r;t++)c=e[t],c<n&&(n=c);return n}function kn(e,t=!1){const r=e.length;if(t)return D(e[0],e[r-1]);let n=e[0],c=0;for(let t=1;t<r;t++)c=e[t],c>n&&(n=c);return n}function En(e,t=!1){const r=e.length;if(0===r)return;if(t)return e[0]>=e[r-1]?0:r-1;let n=0,c=e[0]-1;for(let t=0;t<r;t++){const r=e[t];r>c&&(c=r,n=t)}return n}function qn(e,t=!1){const r=e.length;if(0===r)return;if(t)return e[0]<=e[r-1]?0:r-1;let n=0,c=e[0]+1;for(let t=0;t<r;t++){const r=e[t];r<c&&(c=r,n=t)}return n}function Pn(e){const t=e.length;let r=e[0];for(let n=1;n<t;n++)r*=e[n];return r}function Un(e,t=!1){const r=e.length;if(t){const t=new Float64Array(r);let n=0,c=0,o=e[0],f=0;for(;f<r;)for(resultBlock[n++]=o,c=o;o===c;)o=e[f++];return t.slice(0,n)}{const t={};let n=0;for(let c=0;c<r;c++)n=e[c],t[n]=n;return new Float64Array(t.values())}}function Vn(e,t,r=!1){const n=e.length;if(!r||n<=Mn){for(let r=0;r<n;r++)if(e[r]===t)return r}else{let r=0,c=n-1,o=e[r],f=e[c],u=0,a=0;if(o>f){if(o<t||f>t)return-1;for(;c-r>Mn;)u=$(.5*(r+c)),a=e[u],a>t?r=u:c=u}else{if(o>t||f<t)return-1;for(;c-r>Mn;)u=$(.5*(r+c)),a=e[u],a<t?r=u:c=u}for(;r<=c;){if(array[r]===t)return r;r++}}return-1}function Ln(e,t,r=!1){const n=e.length,c=t.length;if(!r||n+c<Mn){const r={};let o=0;for(let t=0;t<n;t++)o=e[t],store[o]=o;for(let e=0;e<c;e++)o=t[e],store[o]=o;return new Float64Array(r.values())}{const r=[];let o=0,f=0,u=0,a=0,i=NaN,l=NaN;for(;o<n&&f<c;){for(u=e[o],a=t[f],u<a?(u!==i&&(r.push(u),i=u),o++):u>a?(a!==l&&(r.push(a),l=a),f++):(r.push(u),o++,f++);o<n;)r.push(e[o++]);for(;f<c;)r.push(t[f++]);return new Float64Array(r)}}}function Tn(e,t){const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Rn(e,t=new Uint8Array(e.length)){const r=new Uint32Array(256),n=e.length;for(let t=0;t<n;t++)r[e[t]]+=1;let c=0;for(let e=0;e<256;e++){const n=r[e];for(let r=0;r<n;r++)t[c++]=e}return t}function Sn(e,t,r=!1){const n=set.length;let c=0;if(!r||e.length<=Mn)for(let r=0;r<n;r++)e[r]===t&&(c+=1);else{let r,o=0,f=n-1,u=e[o],a=e[f],i=0,l=0;if(u>a){if(u<t||a>t)return 0;for(;f-o>Mn;)if(i=$(.5*(o+f)),l=e[i],l>t)o=i+1;else{if(!(l<t)){r=i;break}f=i-1}}else{if(u>t||a<t)return 0;for(;f-o>Mn;)if(i=$(.5*(o+f)),l=e[i],l<t)o=i+1;else{if(!(l>t)){r=i;break}f=i-1}}if(void 0!==r){let n=r;for(;n-o>Mn;)i=$(.5*(o+n)),l=e[i],l!==t?o=i:n=i;for(;o<=n&&e[o]!==t;)o++;let u=r;for(;f-u>Mn;)i=$(.5*(u+f)),l=e[i],l!==t?u=i:f=i;for(;u<=f&&e[u]!==t;)u++;c=u-o}else for(let r=o;r<=f;r++)e[r]===t&&(c+=1)}return c}function Xn(e){const t="sum(arr)";n(e,"arr",t);const r=Nn(e);return O(r,t),r}function Cn(e,t){const r="min(arr, ?sorted)";return n(e,"arr",r),a(t,"sorted",r),In(e,t)}function Dn(e,t){const r="max(arr, ?sorted)";return n(e,"arr",r),a(t,"sorted",r),kn(e,t)}function Gn(e){return n(e,"arr","prod(arr)"),Pn(e)}function Bn(e,t){const r="unique(arr, ?sorted)";return n(e,"arr",r),a(t,"sorted",r),Un(e,t)}function Qn(e,t,r){const c="indexOf(arr, value, ?sorted)";return a(r,"sorted",c),n(e,"arr",c),i(e,r,"arr",c),Vn(e,t,r)}Object.freeze(Nn),Object.freeze(In),Object.freeze(kn),Object.freeze(Pn),Object.freeze(Un),Object.freeze(Vn),Object.freeze(Ln),Object.freeze(Tn),Object.freeze(Rn),Object.freeze(qn),Object.freeze(En),Object.freeze(Sn),Object.freeze(Xn),Object.freeze(Cn),Object.freeze(Dn),Object.freeze(Gn),Object.freeze(Bn),Object.freeze(Qn);var Yn=Object.freeze({__proto__:null,sum:Xn,min:Cn,max:Dn,prod:Gn,unique:Bn,indexOf:Qn}),Hn=Object.freeze({__proto__:null,debug:Yn,sum:Nn,min:In,max:kn,prod:Pn,unique:Un,indexOf:Vn,union:Ln,equal:Tn,sortUint8:Rn,imin:qn,imax:En,count:Sn}),Wn=Object.freeze({__proto__:null});function Jn(e,t){const r=e.length;let n=0;if(void 0===t)for(let t=0;t<r;t++)n+=e[t];else for(let c=0;c<r;c++)n+=e[c]*t[c];return n}function Kn(e,t){const r=e.length;if(void 0===t)return Jn(e)/r;{let n=0,c=0,o=0;for(let f=0;f<r;f++)o=t[f],n+=e[f]*o,c+=o;return n/c}}function Zn(e,t,r=!0){const n=e.length;let c=0;const o=Kn(e,t);let f=n;if(void 0===t)for(let t=0;t<n;t++){const r=e[t]-o;c+=r*r}else{f=0;for(let r=0;r<n;r++){const n=t[r];f+=n;const o=e[r]-u;c+=n*o*o}}return r&&f>1&&(f-=1),c/f}function ec(e,t,r=!0){return U(Zn(e,t,r))}function tc(e,t,r=!0){meanX=Kn(e),meanY=Kn(t);const n=e.length;let c=0;for(let r=0;r<n;r++)c+=(e[r]-meanX)*(t[r]-meanY);return r&&n>1&&(n-=1),c/n}function rc(e,t,r=!0){if(0===e.length)return;return tc(e,t,r)/(ec(e)*ec(t))}function nc(e,t,r=!1){const n=e.length;if(0!==n){void 0===t&&([e,t]=cc(e,r)),nc={},maxValue=e[0]-1;for(let t=0;t<n;t++){const r=e[t];r>maxValue?(maxValue=r,(nc={})[r]=!0):r===maxValue&&(nc[r]=!0)}return new Float64Array(nc.keys())}}function cc(e,t=!1){const r=e.length;freqeuencies={};for(let t=0;t<r;t++){const r=e[t],n=frequencies[r];frequencies[r]=void 0===n?1:n+1}const n=new Float64Array(frequencies.keys()),c=n.length,o=new Float64Array(c);for(let e=0;e<c;e++)o[e]=frequencies[n[e]];return[n,o]}function oc(e,t,r=!1){return Sn(e,t,r)}function fc(e,t,r){return e<t||e>r?0:1/(t-r)}function uc(e,t,r){return e<t?0:e>r?1:(e-t)/(r-t)}function ac(e,t,r){return t+e*(t-r)}function ic(e,t){return t*R(-t*e)}function lc(e,t){return 1-R(-t*e)}function sc(e,t){return-S(1-e)/t}Object.freeze(Jn),Object.freeze(Kn),Object.freeze(Zn),Object.freeze(ec),Object.freeze(tc),Object.freeze(rc),Object.freeze(nc),Object.freeze(oc),Object.freeze(cc),Object.freeze(fc),Object.freeze(uc),Object.freeze(ac),Object.freeze(ic),Object.freeze(lc),Object.freeze(sc);var zc=Object.freeze({__proto__:null,debug:Wn,sum:Jn,mean:Kn,variance:Zn,sdev:ec,cov:tc,cor:rc,get modes(){return nc},freq:oc,toFreq:cc,unifPdf:fc,unifCdf:uc,unifInvCdf:ac,expPdf:ic,expCdf:lc,expInvCdf:sc});function bc(e,t){void 0===t&&(t=e*_);const r=e-whole;let n=0,c=1,o=1,f=1,u=1,a=2,i=u/a;for(;y(i-e)>t;)r>i?(n=u,c=a,u+=o,a+=f):(o=u,f=a,u+=n,a+=c),i=u/a;const l=new Int32Array(2);return l[0]=u,l[1]=a,l}function Oc(e,t){return x0=t*(1+_),x1=t*(1-_),dx=x1-x0,(e(x1)-e(x0))/dx}Object.freeze(bc),Object.freeze(Oc);var jc=Object.freeze({__proto__:null,frac:bc,deriv:Oc});return e.VERSION="beta-3.0.0",e.array=Hn,e.complex=$n,e.integer=Ie,e.matrix=Mr,e.numerical=jc,e.standard=se,e.statistics=zc,e.vector=er,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
