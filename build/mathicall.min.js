var Mathicall=function(e){"use strict";function r(e){return e.constructor===Number&&!!isFinite(e)}function t(e={},t="",n=""){for(const o in e)if(!r(o[1]))throw`[${n}] ${t}: ${o[0]} must be numeric.`}function n(e={},r="",t=""){for(const n in e)if(!isInteger(n[1]))throw`[${t}] ${r}: ${n[0]} must be an integer.`}function o(e,r="",t=""){(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&console.warn(`[${t}] ${r} large: returned value is approximate.`),e===Number.MAX_VALUE&&console.warn(`[${t}] ${r} overflow: returned Number.MAX_VALUE.`)}Object.freeze(r),Object.freeze(t),Object.freeze(n),Object.freeze(o);const c=Math.E,u=Math.LN2,f=Math.SQRT2,a=Math.PI,l=Math.abs,i=Math.sign,b=Math.round,s=Math.trunc,z=Math.ceil,O=Math.floor,j=Math.sin,m=Math.asin,w=Math.cos,g=Math.acos,d=Math.tan,A=Math.atan,_=Math.atan2,h=Math.sqrt,y=Math.cbrt,F=Math.hypot,p=Math.pow,M=Math.exp,v=Math.log,x=Math.log2,E=Math.log10,N=Math.max,I=Math.min,$=Math.random,L=180/a,R=1/L,T=2*a,V=.5*a,P=1/a;function X(e,r,t){return e+(r-e)*t}function S(e,r){return(e%r+r)%r}function U(e){return e-s(e)}function D(e){return e*L}function G(e){return e*R}function q(e,r,n){return t({x:e,y:r,r:n},"lerp(x, y, r)","std.debug"),X(e,r,n)}function B(e,r){return t({x:e,m:r},"mod(x, m)","std.debug"),S(e,r)}function Q(e){return t({x:e},"fract(x)","std.debug"),U(e)}function k(e){return t({radians:e},"deg(radians)","std.debug"),D(e)}function H(e){return t({degrees:e},"rad(degrees)","std.debug"),G(e)}Object.freeze(X),Object.freeze(S),Object.freeze(U),Object.freeze(D),Object.freeze(G),Object.freeze(q),Object.freeze(B),Object.freeze(Q),Object.freeze(k),Object.freeze(H);var W=Object.freeze({__proto__:null,lerp:q,mod:B,fract:Q,deg:k,rad:H}),C=Object.freeze({__proto__:null,debug:W,E:c,LN2:u,SQRT2:f,PI:a,abs:l,sign:i,round:b,trunc:s,ceil:z,floor:O,sin:j,asin:m,cos:w,acos:g,tan:d,atan:A,atan2:_,sqrt:h,cbrt:y,hypot:F,pow:p,exp:M,ln:v,log2:x,log10:E,max:N,min:I,random:$,RAD_TO_DEG:L,DEG_TO_RAD:R,TWO_PI:T,HALF_PI:V,INV_PI:P,lerp:X,mod:S,fract:U,deg:D,rad:G});function J(e=170){const r=e+1,t=new Float64Array(r);t[0]=1;for(let e=1;e<r;e++)t[e]=e*t[e-1];return t}function K(e=30){const r=new Float64Array(.5*(e+1)*(e+2));let t=-1;for(let n=0;n<=e;n++){r[t++]=1;for(let e=1;e<n;e++)r[t]=r[t-n-1]+r[t-n],t++;r[t++]=1}return r}const Y=J();let Z,ee;function re(e){Z=e,ee=K(e)}function te(e){if(!(e<0))return e>170?Number.MAX_VALUE:Y[e]}function ne(e,r){if(r>e||e<0||r<0)return 0;if(e<=Z)return ee[.5*e*(e+1)+r];const t=I(r,e-r);if(t>514)return Number.MAX_VALUE;const n=e-t;let o=1,c=1;for(;c<=t;)o*=(n+c)/c++;return o}function oe(e,r){if(r>e||e<0||r<0)return 0;if(r>170)return Number.MAX_VALUE;if(r=e-r,e<171)return b(Y[e]/Y[r]);let t=1;for(r<160&&(t=b(Y[170]/Y[r]),r=170);r<e;)t*=++r;return t}function ce(e,r){if(e=l(e),r=l(r),0===e)return r;if(0===r)return e;if(e<4294967296&&r<4294967296){let t=0;for(;0==(1&(e|r));)e>>>=1,r>>>=1,t++;for(;0==(1&e);)e>>>=1;for(;0!==r;){for(;0==(1&r);)r>>>=1;if(e>r){const t=e;e=r,r=t}r-=e}return e<<t}for(;e!==r;)e>r?e-=r:r-=e;return e}function ue(e,r){return 0===e||0===r?0:l(e/ce(e,r)*r)}function fe(e,r,t){if(e=l(e),r=l(r),1===t)return 0;{let n=1;for(e%=t;r>0;)1&r&&(n=n*e%t),r>>=1,e=e**2%t;return n}}function ae(e){n({n:e},"factorial(n)","int.debug");const r=te(e);return o(r,"factorial(n)","int.debug"),r}function le(e,r){n({n:e,r:r},"choose(n, r)","int.debug");const t=ne(e,r);return o(t,"choose(n, r)","int.debug"),t}function ie(e,r){n({n:e,r:r},"permute(n, r)","int.debug");const t=oe(e,r);return o(t,"permute(n, r)","int.debug"),t}function be(e,r){return n({a:e,b:r},"gcd(a, b)","int.debug"),ce(e,r)}function se(e,r){return n({a:e,b:r},"lcm(a, b)","int.debug"),ue(e,r)}function ze(e,r,t){return n({base:e,exp:r,m:t},"mpow(base, exp, m)","int.debug"),fe(e,r,t)}re(30),Object.freeze(J),Object.freeze(K),Object.freeze(re),Object.freeze(te),Object.freeze(ne),Object.freeze(oe),Object.freeze(ce),Object.freeze(ue),Object.freeze(fe),Object.freeze(ae),Object.freeze(le),Object.freeze(ie),Object.freeze(be),Object.freeze(se),Object.freeze(ze);var Oe=Object.freeze({__proto__:null,factorial:ae,choose:le,permute:ie,gcd:be,lcm:se,mpow:ze}),je=Object.freeze({__proto__:null,debug:Oe,computeFactorials:J,computeBinomials:K,precomputeBinomials:re,factorial:te,choose:ne,permute:oe,gcd:ce,lcm:ue,mpow:fe});function me(e,r){let t=0;const n=e.length;for(let o=0;o<n;o++)t+=e[o]*r[o];return t}function we(e,r){return e[0]*r[0]+e[1]*r[1]}function ge(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function de(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}function Ae(e,r,t=new Float64Array(3)){return t[0]=e[1]*r[2]-e[2]*r[1],t[1]=e[2]*r[0]-e[0]*r[2],t[2]=e[0]*r[1]-e[1]*r[0],t}function _e(e,r,t=new Float64Array(e.length)){const n=e.length;for(let o=0;o<n;o++)t[o]=e[o]+r[o];return t}function he(e,r,t=new Float64Array(2)){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function ye(e,r,t=new Float64Array(3)){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Fe(e,r,t=new Float64Array(4)){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function pe(e,r,t=new Float64Array(e.length)){const n=e.length;for(let o=0;o<n;o++)t[o]=e[o]-r[o];return t}function Me(e,r,t=new Float64Array(2)){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function ve(e,r,t=new Float64Array(3)){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function xe(e,r,t=new Float64Array(4)){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function Ee(e){return F(...e)}function Ne(e){return F(e[0],e[1])}function Ie(e){return F(e[0],e[1],e[2])}function $e(e){return F(e[0],e[1],e[2],e[3])}function Le(e,r,t=new Float64Array(e.length)){const n=e.length;for(let o=0;o<n;o++)t[o]=e[o]*r;return t}function Re(e,r,t=new Float64Array(2)){return t[0]=e[0]*r,t[1]=e[1]*r,t}function Te(e,r,t=new Float64Array(3)){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function Ve(e,r,t=new Float64Array(4)){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Pe(e,r){return scale(e,1/Ee(e),r)}function Xe(e,r){return scale2(e,1/Ne(e),r)}function Se(e,r){return scale3(e,1/Ie(e),r)}function Ue(e,r){return scale4(e,1/$e(e),r)}function De(e,r){return g(me(e,r)/(Ee(e)*Ee(r)))}function Ge(e,r){return g(we(e,r)/(Ne(e)*Ne(r)))}function qe(e,r){return g(ge(e,r)/(Ie(e)*Ie(r)))}function Be(e,r){return g(de(e,r)/($e(e)*$e(r)))}function Qe(e,r=new Float64Array(e.length)){const t=e.length;for(let n=0;n<t;n++)r[n]=U(e[n]);return r}function ke(e,r=new Float64Array(2)){return r[0]=U(e[0]),r[1]=U(e[1]),r}function He(e,r=new Float64Array(3)){return r[0]=U(e[0]),r[1]=U(e[1]),r[2]=U(e[2]),r}function We(e,r=new Float64Array(4)){return r[0]=U(e[0]),r[1]=U(e[1]),r[2]=U(e[2]),r[3]=U(e[3]),r}function Ce(e,r=new Float64Array(2)){r[0]=Ne(e),r[1]=_(e[1],e[0])+a}Object.freeze(me),Object.freeze(we),Object.freeze(ge),Object.freeze(de),Object.freeze(Ae),Object.freeze(_e),Object.freeze(he),Object.freeze(ye),Object.freeze(Fe),Object.freeze(pe),Object.freeze(Me),Object.freeze(ve),Object.freeze(xe),Object.freeze(Ee),Object.freeze(Ne),Object.freeze(Ie),Object.freeze($e),Object.freeze(Le),Object.freeze(Re),Object.freeze(Te),Object.freeze(Ve),Object.freeze(Pe),Object.freeze(Xe),Object.freeze(Se),Object.freeze(Ue),Object.freeze(De),Object.freeze(Ge),Object.freeze(qe),Object.freeze(Be),Object.freeze(Qe),Object.freeze(ke),Object.freeze(He),Object.freeze(We),Object.freeze(Ce);var Je=Object.freeze({__proto__:null,dot:me,dot2:we,dot3:ge,dot4:de,cross3:Ae,add:_e,add2:he,add3:ye,add4:Fe,sub:pe,sub2:Me,sub3:ve,sub4:xe,mag:Ee,mag2:Ne,mag3:Ie,mag4:$e,smult:Le,smult2:Re,smult3:Te,smult4:Ve,normalize:Pe,normalize2:Xe,normalize3:Se,normalize4:Ue,angle:De,angle2:Ge,angle3:qe,angle4:Be,fract:Qe,fract2:ke,fract3:He,fract4:We,polar2:Ce});function Ke(e,r){return e[0]*r[0]*w(e[1]-r[1])}function Ye(e){return l(e[0])}function Ze(e,r,t=new Float64Array(2)){t[0]=e[0]*r,t[1]=S(e[1],T)}function er(e,r=new Float64Array(2)){r[0]=1,r[1]=S(e[1],T)}function rr(e,r=new Float64Array(2)){const t=e[0],n=e[1];return r[0]=t*w(n),r[1]=t*j(n),r}Object.freeze(Ke),Object.freeze(Ye),Object.freeze(Ze),Object.freeze(er),Object.freeze(rr);var tr=Object.freeze({__proto__:null,dot2:Ke,mag:Ye,smult2:Ze,normalize2:er,rect2:rr}),nr=Object.freeze({__proto__:null,rect:Je,polar:tr});function or(e,r){const t=new Float64Array(e*r);return t.rows=e,t.cols=r,t}function cr(e,r,t){const n=new Float64Array(e*r);return n.fill(t),n.rows=e,n.cols=r,n}function ur(e){const r=e*e,t=e+1,n=new Float64Array(r);for(let e=0;e<r;e+=t)n[e]=1;return n.rows=e,n.cols=e,n}function fr(e,r=new Float64Array(e.length*e[0].length)){const t=e.length,n=e[0].length;for(let o=0;o<t;o++)for(let c=0;c<n;c++)r[o*t+c]=e[o][c];return r.rows=t,r.cols=n,r}function ar(e,r,t=new Float64Array(e.length)){const n=e.length;for(let o=0;o<n;o++)t[o]=e[o]*r;return t.rows=e.rows,t.cols=e.cols,t}function lr(e,r=new Float64Array(4)){r[0]=e[0],r[3]=e[3];const t=e[1];return r[1]=e[2],r[2]=t,r.rows=2,r.cols=2,r}function ir(e,r=new Float64Array(9)){r[0]=e[0],r[4]=e[4],r[8]=e[8];let t=e[1];return r[1]=e[3],r[3]=t,t=e[2],r[2]=e[6],r[6]=t,t=e[5],r[5]=e[7],r[7]=t,r.rows=3,r.cols=3,r}function br(e,r=new Float64Array(16)){r[0]=e[0],r[5]=e[5],r[10]=e[10],r[15]=e[15];let t=e[1];return r[1]=e[4],r[4]=t,t=e[2],r[2]=e[8],r[8]=t,t=e[3],r[3]=e[12],r[12]=t,t=e[6],r[6]=e[9],r[9]=t,t=e[7],r[7]=e[13],r[13]=t,t=e[11],r[11]=e[14],r[14]=t,r.rows=4,r.cols=4,r}function sr(e,r){const t=e.rows,n=e.cols,o=(r.rows,r.cols),c=new Float64Array(t*o);c.rows=t,c.cols=o;let u=0,f=0,a=0;for(let l=0;l<t;l++)for(let t=0;t<o;t+=1){u=0,f=n*l,a=t;for(let t=0;t<n;t+=1)u+=e[f]*r[a],f+=1,a+=o;c[l*o+t]=u}return c}function zr(e){return[e.rows,e.cols]}function Or(e){return e[0]*e[3]-e[1]*e[2]}function jr(e,r=new Float64Array(4)){const t=e[0],n=e[1],o=e[2],c=e[3],u=t*c-n*o;if(0===u)return;const f=1/u;return r[0]=c*f,r[3]=t*f,r[1]=-n*f,r[2]=-o*f,r.rows=2,r.cols=2,r}Object.freeze(or),Object.freeze(cr),Object.freeze(ur),Object.freeze(fr),Object.freeze(ar),Object.freeze(lr),Object.freeze(ir),Object.freeze(br),Object.freeze(sr),Object.freeze(zr),Object.freeze(Or),Object.freeze(jr);var mr=Object.freeze({__proto__:null,zeros:or,constant:cr,identity:ur,flatten:fr,smult:ar,transpose2:lr,transpose3:ir,transpose4:br,mmult:sr,size:zr,det2:Or,inverse2:jr});function wr(e,r=new Float64Array(2)){return r[0]=e[0],r[1]=-e[1],r}function gr(e){return e[0]}function dr(e){return e[1]}function Ar(e){return _(e[1],e[0])}function _r(e){return F(e[0],e[1])}function hr(e,r,t=new Float64Array(2)){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function yr(e,r,t=new Float64Array(2)){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function Fr(e,r,t=new Float64Array(2)){const n=e[0],o=e[1],c=r[0],u=r[1];return t[0]=n*c-o*u,t[1]=n*u-c*o,t}function pr(e,r,t=new Float64Array(2)){return t[0]=e[0]*r,t[1]=e[1]*r,t}function Mr(e,r,t=new Float64Array(2)){const n=e[0],o=e[1],c=r[0],u=r[1],f=1/(c*c+u*u);return t[0]=(n*c+o*u)*f,t[1]=(-n*u-c*o)*f,t}function vr(e,r=new Float64Array(2)){e[0],e[1];const t=1/(re2*re2+im2*im2);return r[0]=(re1*re2+im1*im2)*t,r[1]=(-re1*im2-re2*im1)*t,r}function xr(e,r=new Float64Array(2)){const t=e[0],n=e[1],o=F(t,n);return r[0]=o,r[1]=_(n,t),r}Object.freeze(wr),Object.freeze(gr),Object.freeze(dr),Object.freeze(Ar),Object.freeze(_r),Object.freeze(hr),Object.freeze(yr),Object.freeze(Fr),Object.freeze(pr),Object.freeze(Mr),Object.freeze(vr),Object.freeze(xr);var Er=Object.freeze({__proto__:null,conj:wr,real:gr,imag:dr,arg:Ar,abs:_r,add:hr,sub:yr,cmult:Fr,smult:pr,div:Mr,inverse:vr,polar:xr});function Nr(e){return(e%=T)>a?e-T:e<-a?e+T:e}function Ir(e,r=new Float64Array(2)){const t=e[0],n=e[1];return t<0?(r[0]=-t,r[1]=-Nr(n+a)):(r[0]=t,r[1]=-Nr(n)),r}function $r(e){return e[0]*w(e[1])}function Lr(e){return e[0]*j(e[1])}function Rr(e){return Nr(e[1])}function Tr(e){return l(e[0])}function Vr(e,r,t=new Float64Array(2)){const n=e[0]*r,o=e[1];return n<0?(t[0]=-n,t[1]=Nr(o+a)):(t[0]=n,t[1]=Nr(o)),t}function Pr(e,r,t=new Float64Array(2)){const n=e[0]*r[0],o=e[1]+r[1];return n<0?(t[0]=-n,t[1]=Nr(o+a)):(t[0]=n,t[1]=Nr(o)),t}function Xr(e,r,t=new Float64Array(2)){const n=r[0];if(0===n)return;const o=e[0]/n,c=e[1]-r[1];return o<0?(t[0]=-o,t[1]=Nr(c+a)):(t[0]=o,t[1]=Nr(c)),t}function Sr(e,r,t=new Float64Array(2)){const n=e[0],o=e[1];return n<0?(t[0]=p(-n,r),t[1]=Nr(r*(o+a))):(t[0]=p(n,r),t[1]=Nr(r*o)),t}function Ur(e,r=new Float64Array(2)){const t=e[0];if(0===t)return;const n=e[1];return t<0?(r[0]=-1/t,r[1]=Nr(-n-a)):(r[0]=1/t,r[1]=Nr(-n)),r}function Dr(e,r=new Float64Array(2)){const t=e[0],n=e[1];return r[0]=t*w(n),r[1]=t*j(n),r}Object.freeze(Ir),Object.freeze($r),Object.freeze(Lr),Object.freeze(Rr),Object.freeze(Tr),Object.freeze(Vr),Object.freeze(Pr),Object.freeze(Xr),Object.freeze(Sr),Object.freeze(Ur),Object.freeze(Dr);var Gr=Object.freeze({__proto__:null,conj:Ir,real:$r,imag:Lr,arg:Rr,abs:Tr,smult:Vr,cmult:Pr,div:Xr,pow:Sr,inverse:Ur,rect:Dr}),qr=Object.freeze({__proto__:null,rect:Er,polar:Gr});function Br(e){const r=e.length;let t=0;for(let n=0;n<r;n++)t+=e[n];return t}function Qr(e,r=!1){const t=e.length;if(r)return I(e[0],e[t-1]);let n=e[0],o=0;for(let r=1;r<t;r++)o=e[r],o<n&&(n=o);return n}function kr(e,r=!1){const t=e.length;if(r)return N(e[0],e[t-1]);let n=e[0],o=0;for(let r=1;r<t;r++)o=e[r],o>n&&(n=o);return n}function Hr(e){const r=e.length;let t=e[0];for(let n=1;n<r;n++)t*=e[n];return t}function Wr(e,r=!1){const t=e.length;if(r){const r=new Float64Array(t);let n=0,o=0,c=e[0],u=0;for(;u<t;)for(resultBlock[n++]=c,o=c;c===o;)c=e[u++];return r.slice(0,n)}{const r={};let n=0;for(let o=0;o<t;o++)n=e[o],r[n]=n;return new Float64Array(r.values())}}function Cr(e,r,t=!1){const n=e.length;if(!t||n<=64){for(let t=0;t<n;t++)if(e[t]===r)return t}else{let t=0,o=n-1,c=e[t],u=e[o],f=0,a=0;if(c>u){if(c<r||u>r)return-1;for(;o-t>64;)f=O(.5*(t+o)),a=e[f],a>r?t=f:o=f}else{if(c>r||u<r)return-1;for(;o-t>64;)f=O(.5*(t+o)),a=e[f],a<r?t=f:o=f}for(;t<=o;){if(array[t]===r)return t;t++}}return-1}Object.freeze(Br),Object.freeze(Qr),Object.freeze(kr),Object.freeze(Hr),Object.freeze(Wr),Object.freeze(Cr);var Jr=Object.freeze({__proto__:null,sum:Br,min:Qr,max:kr,prod:Hr,unique:Wr,indexOf:Cr});return e.VERSION="beta-3.0.0",e.array=Jr,e.complex=qr,e.integer=je,e.matrix=mr,e.standard=C,e.vector=nr,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
