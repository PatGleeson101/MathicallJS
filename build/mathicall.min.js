var Mathicall=function(e){"use strict";let t="Unknown",r={};function n(e,n){t=e;const c=t.split("(")[1].replace(")","").replace(" ","").replace("?","").split(",");r={};for(let e=0;e<c.length;e++)r[params[e]]=n[e]}function c(){r={},t="Unknown"}function o(){console.warn.apply(console,arguments)}Object.freeze((function(){console.log.apply(console,arguments)})),Object.freeze(n),Object.freeze(c),Object.freeze(o);const f=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];function a(e){const n=r[e];if(n.constructor!==Number)throw`${t}: ${e} must be of type Number.`;if(!isFinite(n))throw`${t}: ${e} cannot be NaN or Infinity.`}function i(e,n){const c=r[e];if(f.includes(c.constructor)||Array.isArray(c)){const r=c.length;if(r!==n)throw`${t}: ${e} has incorrect length`;0===r&&o(`${t}: ${e} is empty.`);for(let n=0;n<r;n++){c[n];if(c.constructor!==Number)throw`${t}: ${e} must an array of Numbers.`;if(!isFinite(c))throw`${t}: ${e} contains NaN or Infinity.`}}throw`${t}: ${e} must be an Array or TypedArray.`}function l(e){const n=r[e];if(!Number.isInteger(n))throw`${t}: ${e} must be an integer of type Number.`}function s(e){const n=r[e];if(a(e),n<=0)throw`${t}: ${e} must be positive.`}function b(e){const n=r[e];if(a(e),n<0)throw`${t}: ${e} must be non-negative.`}function z(e){const n=r[e];i(e);const c=n.length;if(c<2)throw`${t}: ${e} must have two components.`;c>2&&console.warn(`${t}: ${e} contains additional values which will be ignored.`),n[0]<0&&console.warn(`${t}: ${e} expressed with negative magnitude.`)}function j(e){const n=r[e];i(e);const c=n.length;if(c<2)throw`${t}: ${e} must have two components.`;c>2&&console.warn(`${t}: ${e} contains additional values which will be ignored.`)}function O(e){l(e),s(e)}function g(e,n,c){i(e);const o=r[e];if(!Number.isInteger(o.nrows)||o.nrows<1)throw`${t}: ${e}.nrows is invalid`;if(!Number.isInteger(o.ncols)||o.ncols<1)throw`${t}: ${e}.ncols is invalid`;if(o.nrows*o.ncols!==o.length)throw`${t}: ${e}.length does not match ${e}.nrows * ${e}.ncols`;if(o.nrows!==n||o.ncols!==c)throw`${t}: ${e} has incorrect dimensions`}function d(e){e>=I&&o(`${t}: overflowed Number.MAX_VALUE`)}function m(e){e>N&&o(`${t}: overflowed Number.MAX_SAFE_INTEGER`)}function v(e){void 0===e&&o(`${t}: output undefined`)}function h(e,n){const c=r[e],o=r[n],f=c.length;if(0!==f&&!0===o){sgn=Math.sign(c[f-1]-c[0]);for(let r=1;r<f;r++){const o=Math.sign(c[r]-c[r-1]);if(0!==o&&o!==sgn)throw`${t}: ${n} set to true, but ${e} unsorted`}}}function w(e){const n=r[e];if(void 0!==n){if(n.constructor!==Number)throw`${t}: If provided, ${e} must be of type Number.`;if(!isFinite(n))throw`${t}: ${e} cannot be NaN or Infinity.`}}function y(e,n){const c=r[e];if(void 0!==c&&(i(c),c.length!==n))throw`${t}: ${e} has incorrect length`}function _(e){const n=r[e];if(void 0!==n&&!0!==n&&!1!==n)throw`${t}: ${e} must be a boolean`}function A(e){void 0!==r[e]&&b(e)}function p(e){void 0!==r[e]&&(b(e),l(e))}Object.freeze(a),Object.freeze(i),Object.freeze(l),Object.freeze(s),Object.freeze(b),Object.freeze((function(e){i(e)})),Object.freeze((function(e){const n=r[e];i(e),n[0]<0&&console.warn(`${t}: ${e} expressed with negative magnitude.`)})),Object.freeze((function(e){const n=r[e];if(!0!==n&&!1!==n)throw`${t}: ${e} must be a boolean value.`})),Object.freeze(z),Object.freeze(j),Object.freeze(g),Object.freeze(O),Object.freeze(d),Object.freeze(m),Object.freeze(v),Object.freeze(w),Object.freeze(h),Object.freeze(y),Object.freeze(_),Object.freeze(p),Object.freeze(A);const x=Math.E,F=Math.LN2,$=Math.SQRT2,M=Math.PI,N=Number.MAX_SAFE_INTEGER,I=Number.MAX_VALUE,C=Number.EPSILON,E=Math.abs,U=Math.sign,k=Math.round,P=Math.trunc,R=Math.ceil,q=Math.floor,X=Math.sin,T=Math.asin,G=Math.cos,S=Math.acos,V=Math.tan,L=Math.atan,D=Math.atan2,B=Math.sqrt,Q=Math.cbrt,Y=Math.hypot,H=Math.pow,W=Math.exp,J=Math.log,K=Math.log2,Z=Math.log10,ee=Math.max,te=Math.min,re=Math.random,ne=180/M,ce=1/ne,oe=2*M,fe=.5*M,ue=1/M;function ae(e,t,r){return e+(t-e)*r}function ie(e,t){return(e%t+t)%t}function le(e){return e-P(e)}function se(e){return e*ne}function be(e){return e*ce}function ze(e,t,r){const n=r[0],c=t[0];return n+(r[1]-n)*(e-c)/(t[1]-c)}function je(e,t,r){return setContext("lerp(x, y, r)",arguments),a("x"),a("y"),a("r"),c(),ae(e,t,r)}function Oe(e,t){return setContext("mod(x, m)",arguments),a("x"),a("m"),c(),ie(e,t)}function ge(e){return setContext("fract(x)",arguments),a("x"),c(),le(e)}function de(e){return setContext("deg(radians)",arguments),a("radians"),c(),se(e)}function me(e){return setContext("rad(degrees)",arguments),a("degrees"),c(),be(e)}function ve(e,t,r){if(setContext("linmap(x, domain, range)",arguments),a("x"),i("domain"),i("range"),t[0]>t[1])throw"linmap(x, domain, range): invalid domain";if(r[0]>r[1])throw"linmap(x, domain, range): invalid range";return c(),ze(e,t,r)}Object.freeze(ae),Object.freeze(ie),Object.freeze(le),Object.freeze(se),Object.freeze(be),Object.freeze(ze),Object.freeze(je),Object.freeze(Oe),Object.freeze(ge),Object.freeze(de),Object.freeze(me),Object.freeze(ve);var he=Object.freeze({__proto__:null,lerp:je,mod:Oe,fract:ge,deg:de,rad:me,linmap:ve}),we=Object.freeze({__proto__:null,debug:he,E:x,LN2:F,SQRT2:$,PI:M,MAX_SAFE_INTEGER:N,MAX_VALUE:I,EPSILON:C,abs:E,sign:U,round:k,trunc:P,ceil:R,floor:q,sin:X,asin:T,cos:G,acos:S,tan:V,atan:L,atan2:D,sqrt:B,cbrt:Q,hypot:Y,pow:H,exp:W,ln:J,log2:K,log10:Z,max:ee,min:te,random:re,RAD_TO_DEG:ne,DEG_TO_RAD:ce,TWO_PI:oe,HALF_PI:fe,INV_PI:ue,lerp:ae,mod:ie,fract:le,deg:se,rad:be,linmap:ze});function ye(e=170){if(e<0)return[];const t=e+1,r=new Float64Array(t);r[0]=1;for(let e=1;e<t;e++)r[e]=e*r[e-1];return r}function _e(e=30){const t=new Float64Array(.5*(e+1)*(e+2));let r=-1;for(let n=0;n<=e;n++){t[r++]=1;for(let e=1;e<n;e++)t[r]=t[r-n-1]+t[r-n],r++;t[r++]=1}return t}const Ae=ye();let pe,xe;function Fe(e){pe=e,xe=_e(e)}function $e(e){if(!(e<0))return e>170?I:Ae[e]}function Me(e,t){if(t>e||e<0||t<0)return 0;if(e<=pe)return xe[.5*e*(e+1)+t];const r=te(t,e-t);if(r>514)return I;const n=e-r;let c=1,o=1;for(;o<=r;)c*=(n+o)/o++;return c}function Ne(e,t){if(t>e||e<0||t<0)return 0;if((t=e-t)>170)return I;if(e<171)return k(Ae[e]/Ae[t]);let r=1;for(t<160&&(r=k(Ae[170]/Ae[t]),t=170);t<e;)r*=++t;return r}function Ie(e,t){if(e=E(e),t=E(t),0===e)return t;if(0===t)return e;if(e<4294967296&&t<4294967296){let r=0;for(;0==(1&(e|t));)e>>>=1,t>>>=1,r++;for(;0==(1&e);)e>>>=1;for(;0!==t;){for(;0==(1&t);)t>>>=1;if(e>t){const r=e;e=t,t=r}t-=e}return e<<r}for(;e!==t;)e>t?e-=t:t-=e;return e}function Ce(e,t){return 0===e||0===t?0:E(e/Ie(e,t)*t)}function Ee(e,t,r){if(t=E(t),1===r)return 0;{let n=1;for(e%=r;t>0;)1&t&&(n=n*e%r),t>>=1,e=e**2%r;return n}}function Ue(e){n("factorial(n)",arguments),l("n"),b("n");const t=$e(e);return d(t),m(t),c(),t}function ke(e,t){n("choose(n, r)",arguments),l("n"),l("r");const r=Me(e,t);return d(r),m(r),c(),r}function Pe(e,t){n("permute(n, r)",arguments),l("n"),l("r");const r=Ne(e,t);return d(r),m(r),c(),r}function Re(e,t){return n("gcd(a, b)",arguments),l("a"),l("b"),c(),Ie(e,t)}function qe(e,t){return n("lcm(a, b)",arguments),l("a"),l("b"),c(),Ce(e,t)}function Xe(e,t,r){return n("mpow(base, exp, m)",arguments),l("base"),l("exp"),b("exp"),l("m"),c(),Ee(e,t,r)}Fe(30),Object.freeze(ye),Object.freeze(_e),Object.freeze(Fe),Object.freeze($e),Object.freeze(Me),Object.freeze(Ne),Object.freeze(Ie),Object.freeze(Ce),Object.freeze(Ee),Object.freeze(Ue),Object.freeze(ke),Object.freeze(Pe),Object.freeze(Re),Object.freeze(qe),Object.freeze(Xe);var Te=Object.freeze({__proto__:null,factorial:Ue,choose:ke,permute:Pe,gcd:Re,lcm:qe,mpow:Xe}),Ge=Object.freeze({__proto__:null,debug:Te,computeFactorials:ye,computeBinomials:_e,precomputeBinomials:Fe,factorial:$e,choose:Me,permute:Ne,gcd:Ie,lcm:Ce,mpow:Ee});function Se(e,t){let r=0;const n=e.length;for(let c=0;c<n;c++)r+=e[c]*t[c];return r}function Ve(e,t){return e[0]*t[0]+e[1]*t[1]}function Le(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function De(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Be(e,t,r=new Float64Array(3)){return r[0]=e[1]*t[2]-e[2]*t[1],r[1]=e[2]*t[0]-e[0]*t[2],r[2]=e[0]*t[1]-e[1]*t[0],r}function Qe(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]+t[c];return r}function Ye(e,t,r=new Float64Array(2)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function He(e,t,r=new Float64Array(3)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function We(e,t,r=new Float64Array(4)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function Je(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]-t[c];return r}function Ke(e,t,r=new Float64Array(2)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}function Ze(e,t,r=new Float64Array(3)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function et(e,t,r=new Float64Array(4)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function tt(e){return Y(...e)}function rt(e){return Y(e[0],e[1])}function nt(e){return Y(e[0],e[1],e[2])}function ct(e){return Y(e[0],e[1],e[2],e[3])}function ot(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]*t;return r}function ft(e,t,r=new Float64Array(2)){return r[0]=e[0]*t,r[1]=e[1]*t,r}function ut(e,t,r=new Float64Array(3)){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function at(e,t,r=new Float64Array(4)){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function it(e,t){return ot(e,1/tt(e),t)}function lt(e,t){return ft(e,1/rt(e),t)}function st(e,t){return ut(e,1/nt(e),t)}function bt(e,t){return at(e,1/ct(e),t)}function zt(e,t){return S(Se(e,t)/(tt(e)*tt(t)))}function jt(e,t){return S(Ve(e,t)/(rt(e)*rt(t)))}function Ot(e,t){return S(Le(e,t)/(nt(e)*nt(t)))}function gt(e,t){return S(De(e,t)/(ct(e)*ct(t)))}function dt(e,t=new Float64Array(e.length)){const r=e.length;for(let n=0;n<r;n++)t[n]=le(e[n]);return t}function mt(e,t=new Float64Array(2)){return t[0]=le(e[0]),t[1]=le(e[1]),t}function vt(e,t=new Float64Array(3)){return t[0]=le(e[0]),t[1]=le(e[1]),t[2]=le(e[2]),t}function ht(e,t=new Float64Array(4)){return t[0]=le(e[0]),t[1]=le(e[1]),t[2]=le(e[2]),t[3]=le(e[3]),t}function wt(e,t=new Float64Array(2)){return t[0]=rt(e),t[1]=D(e[1],e[0])+M,t}function yt(e,t){return n("dot(vec1, vec2)",arguments),i("vec1"),i("vec2",e.length),c(),Se(e,t)}function _t(e,t){return n("dot2(vec1, vec2)",arguments),i("vec1",2),i("vec2",2),c(),Ve(e,t)}function At(e,t){return n("dot3(vec1, vec2)",arguments),i("vec1",3),i("vec2",3),c(),Le(e,t)}function pt(e,t){return n("dot4(vec1, vec2)",arguments),i("vec1",4),i("vec2",4),c(),De(e,t)}function xt(e,t,r){return n("cross3(vec1, vec2, ?target)",arguments),i("vec1",3),i("vec2",3),y("target",3),c(),Be(e,t,r)}function Ft(e,t,r){return n("add(vec1, vec2, ?target)",arguments),i("vec1"),i("vec2",e.length),y("target",e.length),c(),Qe(e,t,r)}function $t(e,t,r){return n("add2(vec1, vec2, ?target)",arguments),i("vec1",2),i("vec2",2),y("target",2),c(),Ye(e,t,r)}function Mt(e,t,r){return n("add3(vec1, vec2, ?target)",arguments),i("vec1",3),i("vec2",3),y("target",3),c(),He(e,t,r)}function Nt(e,t,r){return n("add4(vec1, vec2, ?target)",arguments),i("vec1",4),i("vec2",4),y("target",4),c(),We(e,t,r)}function It(e,t,r){return n("sub(vec1, vec2, ?target)",arguments),i("vec1",2),i("vec2",e.length),y("target",e.length),c(),Je(e,t,r)}function Ct(e,t,r){return n("sub2(vec1, vec2, ?target)",arguments),i("vec1",2),i("vec2",2),y("target",2),c(),Ke(e,t,r)}function Et(e,t,r){return n("sub3(vec1, vec2, ?target)",arguments),i("vec1",3),i("vec2",3),y("target",3),c(),Ze(e,t,r)}function Ut(e,t,r){return n("sub4(vec1, vec2, ?target)",arguments),i("vec1",4),i("vec2",4),y("target",4),c(),et(e,t,r)}function kt(e){return n("mag(vec)",arguments),i("vec"),c(),tt(e)}function Pt(e){return n("mag2(vec)",arguments),i("vec",2),c(),rt(e)}function Rt(e){return n("mag3(vec)",arguments),i("vec",3),c(),nt(e)}function qt(e){return n("mag4(vec)",arguments),i("vec",4),c(),ct(e)}function Xt(e,t,r){return n("scale(vec, k, ?target)",arguments),i("vec"),a("k"),y("target",e.length),ot(e,t,r)}function Tt(e,t,r){return n("scale2(vec, k, ?target)",arguments),i("vec",2),a("k"),y("target",2),ft(e,t,r)}function Gt(e,t,r){return n("scale3(vec, k, ?target)",arguments),i("vec",3),a("k"),y("target",3),ut(e,t,r)}function St(e,t,r){return n("scale4(vec, k, ?target)",arguments),i("vec",4),a("k"),y("target",4),at(e,t,r)}function Vt(e,t){return n("normalize(vec, ?target)",arguments),i("vec"),y("target",e.length),it(e,t)}function Lt(e,t){return n("normalize2(vec, ?target)",arguments),i("vec",2),y("target",2),lt(e,t)}function Dt(e,t){return n("normalize3(vec, ?target)",arguments),i("vec",3),y("target",3),st(e,t)}function Bt(e,t){return n("normalize4(vec, ?target)",arguments),i("vec",4),y("target",4),bt(e,t)}function Qt(e,t){return n("angle(vec1, vec2)",arguments),i("vec1"),i("vec2",e.length),zt(e,t)}function Yt(e,t){return n("angle2(vec1, vec2)",arguments),i("vec1",2),i("vec2",2),jt(e,t)}function Ht(e,t){return n("angle3(vec1, vec2)",arguments),i("vec1",3),i("vec2",3),Ot(e,t)}function Wt(e,t){return n("angle4(vec1, vec2)",arguments),i("vec1",4),i("vec2",4),gt(e,t)}function Jt(e,t){return n("fract(vec, ?target)",arguments),i("vec"),y("target",e.length),dt(e,t)}function Kt(e,t){return n("fract2(vec, ?target)",arguments),i("vec",2),y("target",2),mt(e,t)}function Zt(e,t){return n("fract3(vec, ?target)",arguments),i("vec",3),y("target",3),vt(e,t)}function er(e,t){return n("fract4(vec, ?target)",arguments),i("vec",4),y("target",4),ht(e,t)}function tr(e,t){return n("polar2(vec, ?target)",arguments),i("vec",2),y("target",2),wt(e,t)}Object.freeze(Se),Object.freeze(Ve),Object.freeze(Le),Object.freeze(De),Object.freeze(Be),Object.freeze(Qe),Object.freeze(Ye),Object.freeze(He),Object.freeze(We),Object.freeze(Je),Object.freeze(Ke),Object.freeze(Ze),Object.freeze(et),Object.freeze(tt),Object.freeze(rt),Object.freeze(nt),Object.freeze(ct),Object.freeze(ot),Object.freeze(ft),Object.freeze(ut),Object.freeze(at),Object.freeze(it),Object.freeze(lt),Object.freeze(st),Object.freeze(bt),Object.freeze(zt),Object.freeze(jt),Object.freeze(Ot),Object.freeze(gt),Object.freeze(dt),Object.freeze(mt),Object.freeze(vt),Object.freeze(ht),Object.freeze(wt),Object.freeze(yt),Object.freeze(_t),Object.freeze(At),Object.freeze(pt),Object.freeze(xt),Object.freeze(Ft),Object.freeze($t),Object.freeze(Mt),Object.freeze(Nt),Object.freeze(It),Object.freeze(Ct),Object.freeze(Et),Object.freeze(Ut),Object.freeze(kt),Object.freeze(Pt),Object.freeze(Rt),Object.freeze(qt),Object.freeze(Xt),Object.freeze(Tt),Object.freeze(Gt),Object.freeze(St),Object.freeze(Vt),Object.freeze(Lt),Object.freeze(Dt),Object.freeze(Bt),Object.freeze(Qt),Object.freeze(Yt),Object.freeze(Ht),Object.freeze(Wt),Object.freeze(Jt),Object.freeze(Kt),Object.freeze(Zt),Object.freeze(er),Object.freeze(tr);var rr=Object.freeze({__proto__:null,dot:yt,dot2:_t,dot3:At,dot4:pt,cross3:xt,add:Ft,add2:$t,add3:Mt,add4:Nt,sub:It,sub2:Ct,sub3:Et,sub4:Ut,mag:kt,mag2:Pt,mag3:Rt,mag4:qt,scale:Xt,scale2:Tt,scale3:Gt,scale4:St,normalize:Vt,normalize2:Lt,normalize3:Dt,normalize4:Bt,angle:Qt,angle2:Yt,angle3:Ht,angle4:Wt,fract:Jt,fract2:Kt,fract3:Zt,fract4:er,toPolar2:tr}),nr=Object.freeze({__proto__:null,debug:rr,dot:Se,dot2:Ve,dot3:Le,dot4:De,cross3:Be,add:Qe,add2:Ye,add3:He,add4:We,sub:Je,sub2:Ke,sub3:Ze,sub4:et,mag:tt,mag2:rt,mag3:nt,mag4:ct,scale:ot,scale2:ft,scale3:ut,scale4:at,normalize:it,normalize2:lt,normalize3:st,normalize4:bt,angle:zt,angle2:jt,angle3:Ot,angle4:gt,fract:dt,fract2:mt,fract3:vt,fract4:ht,toPolar2:wt});function cr(e,t){return e[0]*t[0]*G(e[1]-t[1])}function or(e){return E(e[0])}function fr(e,t,r=new Float64Array(2)){return r[0]=e[0]*t,r[1]=ie(e[1],oe),r}function ur(e,t=new Float64Array(2)){if(0!==e[0])return t[0]=1,t[1]=ie(e[1],oe),t}function ar(e,t=new Float64Array(2)){const r=e[0],n=e[1];return t[0]=r*G(n),t[1]=r*X(n),t}Object.freeze(cr),Object.freeze(or),Object.freeze(fr),Object.freeze(ur),Object.freeze(ar);var ir=Object.freeze({__proto__:null,dot2:cr,mag:or,scale2:fr,normalize2:ur,toRect2:ar}),lr=Object.freeze({__proto__:null,rect:nr,polar:ir,debug:rr,dot:Se,dot2:Ve,dot3:Le,dot4:De,cross3:Be,add:Qe,add2:Ye,add3:He,add4:We,sub:Je,sub2:Ke,sub3:Ze,sub4:et,mag:tt,mag2:rt,mag3:nt,mag4:ct,scale:ot,scale2:ft,scale3:ut,scale4:at,normalize:it,normalize2:lt,normalize3:st,normalize4:bt,angle:zt,angle2:jt,angle3:Ot,angle4:gt,fract:dt,fract2:mt,fract3:vt,fract4:ht,toPolar2:wt});const sr=64;function br(e){const t=e.length;let r=0;for(let n=0;n<t;n++)r+=e[n];return r}function zr(e,t=!1){const r=e.length;if(t)return te(e[0],e[r-1]);let n=e[0],c=0;for(let t=1;t<r;t++)c=e[t],c<n&&(n=c);return n}function jr(e,t=!1){const r=e.length;if(t)return ee(e[0],e[r-1]);let n=e[0],c=0;for(let t=1;t<r;t++)c=e[t],c>n&&(n=c);return n}function Or(e,t=!1){const r=e.length;if(0===r)return;if(t)return e[0]>=e[r-1]?0:r-1;let n=0,c=e[0]-1;for(let t=0;t<r;t++){const r=e[t];r>c&&(c=r,n=t)}return n}function gr(e,t=!1){const r=e.length;if(0===r)return;if(t)return e[0]<=e[r-1]?0:r-1;let n=0,c=e[0]+1;for(let t=0;t<r;t++){const r=e[t];r<c&&(c=r,n=t)}return n}function dr(e){const t=e.length;let r=1;for(let n=1;n<t;n++)r*=e[n];return r}function mr(e,t=!1){const r=e.length;if(t){const t=new Float64Array(r);let n=0,c=0,o=e[0],f=0;for(;f<r;)for(t[n++]=o,c=o;o===c;)o=e[f++];return t.slice(0,n)}{const t={};let n=0;for(let c=0;c<r;c++)n=e[c],t[n]=n;return new Float64Array(Object.values(t))}}function vr(e,t,r=!1){const n=e.length;if(!r||n<=sr){for(let r=0;r<n;r++)if(e[r]===t)return r}else{let r=0,c=n-1,o=e[r],f=e[c],u=0,a=0;if(o>f){if(o<t||f>t)return-1;for(;c-r>sr;)u=q(.5*(r+c)),a=e[u],a>t?r=u:c=u}else{if(o>t||f<t)return-1;for(;c-r>sr;)u=q(.5*(r+c)),a=e[u],a<t?r=u:c=u}for(;r<=c;){if(e[r]===t)return r;r++}}return-1}function hr(e,t,r=!1){const n=e.length,c=t.length;if(!r||n+c<sr){const r={};let o=0;for(let t=0;t<n;t++)o=e[t],r[o]=o;for(let e=0;e<c;e++)o=t[e],r[o]=o;return new Float64Array(Object.values(r))}{const r=[];let o=0,f=0,u=0,a=0,i=NaN,l=NaN;for(;o<n&&f<c;){for(u=e[o],a=t[f],u<a?(u!==i&&(r.push(u),i=u),o++):u>a?(a!==l&&(r.push(a),l=a),f++):(u!==i&&r.push(u),o++,f++);o<n;)r.push(e[o++]);for(;f<c;)r.push(t[f++]);return new Float64Array(r)}}}function wr(e,t){const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function yr(e,t=new Uint8Array(e.length)){const r=new Uint32Array(256),n=e.length;for(let t=0;t<n;t++)r[e[t]]+=1;let c=0;for(let e=0;e<256;e++){const n=r[e];for(let r=0;r<n;r++)t[c++]=e}return t}function _r(e,t,r=!1){const n=e.length;let c=0;if(!r||e.length<=sr)for(let r=0;r<n;r++)e[r]===t&&(c+=1);else{let r,o=0,f=n-1,u=e[o],a=e[f],i=0,l=0;if(u>a){if(u<t||a>t)return 0;for(;f-o>sr;)if(i=q(.5*(o+f)),l=e[i],l>t)o=i+1;else{if(!(l<t)){r=i;break}f=i-1}}else{if(u>t||a<t)return 0;for(;f-o>sr;)if(i=q(.5*(o+f)),l=e[i],l<t)o=i+1;else{if(!(l>t)){r=i;break}f=i-1}}if(void 0!==r){let n=r;for(;n-o>sr;)i=q(.5*(o+n)),l=e[i],l!==t?o=i:n=i;for(;o<=n&&e[o]!==t;)o++;let u=r;for(;f-u>sr;)i=q(.5*(u+f)),l=e[i],l!==t?f=i:u=i;for(;f>=u&&e[f]!==t;)f--;c=f-o+1}else for(let r=o;r<=f;r++)e[r]===t&&(c+=1)}return c}function Ar(e,t){const r=new Float64Array(e*t);return r.nrows=e,r.ncols=t,r}function pr(e,t,r){const n=new Float64Array(e*t);return n.fill(r),n.nrows=e,n.ncols=t,n}function xr(e){const t=e*e,r=e+1,n=new Float64Array(t);for(let e=0;e<t;e+=r)n[e]=1;return n.nrows=e,n.ncols=e,n}function Fr(e,t=new Float64Array(e.length*e[0].length)){const r=e.length,n=e[0].length;for(let c=0;c<r;c++)for(let o=0;o<n;o++)t[c*r+o]=e[c][o];return t.nrows=r,t.ncols=n,t}function $r(e,t,r=new Float64Array(e.length)){const n=e.length;for(let c=0;c<n;c++)r[c]=e[c]*t;return r.nrows=e.nrows,r.ncols=e.ncols,r}function Mr(e,t=new Float64Array(4)){t[0]=e[0],t[3]=e[3];const r=e[1];return t[1]=e[2],t[2]=r,t.nrows=2,t.ncols=2,t}function Nr(e,t=new Float64Array(9)){t[0]=e[0],t[4]=e[4],t[8]=e[8];let r=e[1];return t[1]=e[3],t[3]=r,r=e[2],t[2]=e[6],t[6]=r,r=e[5],t[5]=e[7],t[7]=r,t.nrows=3,t.ncols=3,t}function Ir(e,t=new Float64Array(16)){t[0]=e[0],t[5]=e[5],t[10]=e[10],t[15]=e[15];let r=e[1];return t[1]=e[4],t[4]=r,r=e[2],t[2]=e[8],t[8]=r,r=e[3],t[3]=e[12],t[12]=r,r=e[6],t[6]=e[9],t[9]=r,r=e[7],t[7]=e[13],t[13]=r,r=e[11],t[11]=e[14],t[14]=r,t.nrows=4,t.ncols=4,t}function Cr(e,t){const r=e.nrows,n=e.ncols,c=(t.nrows,t.ncols),o=new Float64Array(r*c);o.nrows=r,o.ncols=c;let f=0,u=0,a=0;for(let i=0;i<r;i++)for(let r=0;r<c;r+=1){f=0,u=n*i,a=r;for(let r=0;r<n;r+=1)f+=e[u]*t[a],u+=1,a+=c;o[i*c+r]=f}return o}function Er(e){return[e.nrows,e.ncols]}function Ur(e){return e[0]*e[3]-e[1]*e[2]}function kr(e,t=new Float64Array(4)){const r=e[0],n=e[1],c=e[2],o=e[3],f=r*o-n*c;if(0===f)return;const u=1/f;return t[0]=o*u,t[3]=r*u,t[1]=-n*u,t[2]=-c*u,t.nrows=2,t.ncols=2,t}function Pr(e,t){const r=t.ncols,n=e.length;if(n!==t.nrows)return;const c=new Float64Array(r);let o=0;for(let f=0;f<n;f++){vi=e[f];for(let e=0;e<r;e++)c[e]+=vi*t[o++]}return c}function Rr(e,t){const r=new Float64Array(2),n=e[0],c=e[1];return r[0]=n*t[0]+c*t[2],r[0]=n*t[1]+c*t[3],r}function qr(e,t){e.nrows;const r=e.ncols,n=e.length;if(t.length!==r)return;const c=new Float64Array(r);for(let o=0;o<r;o++){vj=t[o];let f=0;for(let t=o;t<n;t+=r)c[f++]+=vj*e[t]}return c}function Xr(e,t){return e.nrows===t.nrows&&e.ncols===t.ncols&&wr(e,t)}function Tr(e,t){return n("zeros(m, n)",arguments),O("m"),O("n"),c(),Ar(e,t)}function Gr(e,t,r){return n("constant(m, n, value)",arguments),O("m"),O("n"),a("value"),c(),pr(e,t,r)}function Sr(e){return n("identity(m)",arguments),O("m"),c(),xr(e)}function Vr(e,t,r){return n("scale(mat, k, target)",arguments),g("mat"),a("k"),y("target",e.length),c(),$r(e,t,r)}function Lr(e,t){return n("transpose2x2(mat, target)",arguments),g("mat",2,2),y("target",e.length),c(),Mr(e,t)}function Dr(e,t){return n("transpose3x3(mat, target)",arguments),g("mat",3,3),y("target",e.length),c(),Nr(e,t)}function Br(e,t){return n("transpose4x4(mat, target)",arguments),g("mat",[4,4]),y("target",e.length),c(),Ir(e,t)}function Qr(e,t){return n("mult(mat1, mat2)",arguments),g("mat1"),g("mat2",e.ncols),c(),Cr(e,t)}function Yr(e){return n("size(mat)",arguments),g("mat"),c(),Er(e)}function Hr(e){return n("det2x2(mat)",arguments),g("mat",2,2),c(),Ur(e)}function Wr(e,t){return n("inverse2(mat, target)",arguments),g("mat",2,2),y("target",4),c(),kr(e,t)}Object.freeze(br),Object.freeze(zr),Object.freeze(jr),Object.freeze(dr),Object.freeze(mr),Object.freeze(vr),Object.freeze(hr),Object.freeze(wr),Object.freeze(yr),Object.freeze(gr),Object.freeze(Or),Object.freeze(_r),Object.freeze(Ar),Object.freeze(pr),Object.freeze(xr),Object.freeze(Fr),Object.freeze($r),Object.freeze(Mr),Object.freeze(Nr),Object.freeze(Ir),Object.freeze(Cr),Object.freeze(Er),Object.freeze(Ur),Object.freeze(kr),Object.freeze(Pr),Object.freeze(Rr),Object.freeze(qr),Object.freeze(Xr),Object.freeze(Tr),Object.freeze(Gr),Object.freeze(Sr),Object.freeze(Vr),Object.freeze(Lr),Object.freeze(Dr),Object.freeze(Br),Object.freeze(Qr),Object.freeze(Yr),Object.freeze(Hr),Object.freeze(Wr);var Jr=Object.freeze({__proto__:null,zeros:Tr,constant:Gr,identity:Sr,scale:Vr,transpose2x2:Lr,transpose3x3:Dr,transpose4x4:Br,mult:Qr,size:Yr,det2x2:Hr,inverse2x2:Wr}),Kr=Object.freeze({__proto__:null,debug:Jr,zeros:Ar,constant:pr,identity:xr,flatten:Fr,scale:$r,transpose2x2:Mr,transpose3x3:Nr,transpose4x4:Ir,mult:Cr,size:Er,det2x2:Ur,inverse2x2:kr,vmult:Pr,vmult2x2:Rr,multv:qr,isEqual:Xr});function Zr(e,t=new Float64Array(2)){return t[0]=e[0],t[1]=-e[1],t}function en(e){return e[0]}function tn(e){return e[1]}function rn(e){return D(e[1],e[0])}function nn(e){return Y(e[0],e[1])}function cn(e,t,r=new Float64Array(2)){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function on(e,t,r=new Float64Array(2)){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}function fn(e,t,r=new Float64Array(2)){const n=e[0],c=e[1],o=t[0],f=t[1];return r[0]=n*o-c*f,r[1]=n*f-o*c,r}function un(e,t,r=new Float64Array(2)){return r[0]=e[0]*t,r[1]=e[1]*t,r}function an(e,t,r=new Float64Array(2)){const n=e[0],c=e[1],o=t[0],f=t[1],u=1/(o*o+f*f);return r[0]=(n*o+c*f)*u,r[1]=(-n*f-o*c)*u,r}function ln(e,t=new Float64Array(2)){e[0],e[1];const r=1/(re2*re2+im2*im2);return t[0]=(re1*re2+im1*im2)*r,t[1]=(-re1*im2-re2*im1)*r,t}function sn(e,t=new Float64Array(2)){const r=e[0],n=e[1],c=Y(r,n);return t[0]=c,t[1]=D(n,r),t}function bn(e,t){return setContext("conj(z, ?target)",arguments),j("z"),y("target",2),c(),Zr(e,t)}function zn(e){return setContext("real(z)",arguments),j("z"),c(),en(e)}function jn(e){return setContext("imag(z)",arguments),j("z"),c(),tn(e)}function On(e){return setContext("arg(z)",arguments),j("z"),c(),rn(e)}function gn(e){return setContext("abs(z)",arguments),j("z"),c(),nn(e)}function dn(e,t,r){return setContext("add(z1, z2, ?target)",arguments),j("z1"),j("z2"),y("target",2),c(),cn(e,t,r)}function mn(e,t,r){return setContext("sub(z1, z2, ?target)",arguments),j("z1"),j("z2"),y("target",2),c(),on(e,t,r)}function vn(e,t,r){return setContext("mult(z1, z2, ?target)",arguments),j("z1"),j("z2"),y("target",2),c(),fn(e,t,r)}function hn(e,t,r){return setContext("scale(z, k, ?target)",arguments),j("z"),a("k"),y("target",2),c(),un(e,t,r)}function wn(e,t,r){setContext("div(z1, z2, ?target)",arguments),j("z1"),j("z2"),y("target",2);const n=an(e,t,r);return v(n),c(),n}function yn(e,t){setContext("inverse(z, ?target)",arguments),j("z"),y("target",2);const r=ln(e,t);return v(r),c(),r}function _n(e,t){setContext("toPolar(z, ?target)",arguments),j("z"),y("target",2);const r=sn(e,t);return v(r),c(),r}Object.freeze(Zr),Object.freeze(en),Object.freeze(tn),Object.freeze(rn),Object.freeze(nn),Object.freeze(cn),Object.freeze(on),Object.freeze(fn),Object.freeze(un),Object.freeze(an),Object.freeze(ln),Object.freeze(sn),Object.freeze(bn),Object.freeze(zn),Object.freeze(jn),Object.freeze(On),Object.freeze(gn),Object.freeze(dn),Object.freeze(mn),Object.freeze(vn),Object.freeze(hn),Object.freeze(wn),Object.freeze(yn),Object.freeze(_n);var An=Object.freeze({__proto__:null,conj:bn,real:zn,imag:jn,arg:On,abs:gn,add:dn,sub:mn,mult:vn,scale:hn,div:wn,inverse:yn,toPolar:_n}),pn=Object.freeze({__proto__:null,debug:An,conj:Zr,real:en,imag:tn,arg:rn,abs:nn,add:cn,sub:on,mult:fn,scale:un,div:an,inverse:ln,toPolar:sn});function xn(e){return(e%=oe)>M?e-oe:e<-M?e+oe:e}function Fn(e,t=new Float64Array(2)){const r=e[0],n=e[1];return r<0?(t[0]=-r,t[1]=-xn(n+M)):(t[0]=r,t[1]=-xn(n)),t}function $n(e){return e[0]*G(e[1])}function Mn(e){return e[0]*X(e[1])}function Nn(e){return xn(e[1])}function In(e){return E(e[0])}function Cn(e,t,r=new Float64Array(2)){const n=e[0]*t,c=e[1];return n<0?(r[0]=-n,r[1]=xn(c+M)):(r[0]=n,r[1]=xn(c)),r}function En(e,t,r=new Float64Array(2)){const n=e[0]*t[0],c=e[1]+t[1];return n<0?(r[0]=-n,r[1]=xn(c+M)):(r[0]=n,r[1]=xn(c)),r}function Un(e,t,r=new Float64Array(2)){const n=t[0];if(0===n)return;const c=e[0]/n,o=e[1]-t[1];return c<0?(r[0]=-c,r[1]=xn(o+M)):(r[0]=c,r[1]=xn(o)),r}function kn(e,t,r=new Float64Array(2)){const n=e[0],c=e[1];return n<0?(r[0]=H(-n,t),r[1]=xn(t*(c+M))):(r[0]=H(n,t),r[1]=xn(t*c)),r}function Pn(e,t=new Float64Array(2)){const r=e[0];if(0===r)return;const n=e[1];return r<0?(t[0]=-1/r,t[1]=xn(-n-M)):(t[0]=1/r,t[1]=xn(-n)),t}function Rn(e,t=new Float64Array(2)){const r=e[0],n=e[1];return t[0]=r*G(n),t[1]=r*X(n),t}function qn(e,t){return n("conj(z, ?target)",arguments),y("target",2),z("z"),c(),Fn(e,t)}function Xn(e){return n("real(z)",arguments),z("z"),c(),$n(e)}function Tn(e){return n("imag(z)",arguments),z("z"),c(),Mn(e)}function Gn(e){return n("arg(z)",arguments),z("z"),c(),Nn(e)}function Sn(e){return n("abs(z)",arguments),z("z"),c(),In(e)}function Vn(e,t,r){return n("scale(z, k, ?target)",arguments),z("z"),a("k"),y("target",2),c(),Cn(e,t,r)}function Ln(e,t,r){return n("mult(z1, z2, ?target)",arguments),z("z1"),z("z2"),y("target",2),En(e,t,r)}function Dn(e,t,r){n("div(z1, z2, ?target)",arguments),z("z1"),z("z2"),y("target",2);const o=Un(e,t,r);return v(o),c(),o}function Bn(e,t,r){return n("pow(z, n, ?target)",arguments),z("z"),a("n"),y("target",2),c(),kn(e,t,r)}function Qn(e,t){return n("inverse(z, ?target)",arguments),z("z"),y("target",2),c(),Pn(e,t)}function Yn(e,t){return n("toRect(z, ?target)",arguments),z("z"),y("target",2),c(),Rn(e,t)}Object.freeze(Fn),Object.freeze($n),Object.freeze(Mn),Object.freeze(Nn),Object.freeze(In),Object.freeze(Cn),Object.freeze(En),Object.freeze(Un),Object.freeze(kn),Object.freeze(Pn),Object.freeze(Rn),Object.freeze(qn),Object.freeze(Xn),Object.freeze(Tn),Object.freeze(Gn),Object.freeze(Sn),Object.freeze(Vn),Object.freeze(Ln),Object.freeze(Dn),Object.freeze(Bn),Object.freeze(Qn),Object.freeze(Yn);var Hn=Object.freeze({__proto__:null,conj:qn,real:Xn,imag:Tn,arg:Gn,abs:Sn,scale:Vn,mult:Ln,div:Dn,pow:Bn,inverse:Qn,toRect:Yn}),Wn=Object.freeze({__proto__:null,debug:Hn,conj:Fn,real:$n,imag:Mn,arg:Nn,abs:In,scale:Cn,mult:En,div:Un,pow:kn,inverse:Pn,toRect:Rn}),Jn=Object.freeze({__proto__:null,rect:pn,polar:Wn,debug:An,conj:Zr,real:en,imag:tn,arg:rn,abs:nn,add:cn,sub:on,mult:fn,scale:un,div:an,inverse:ln,toPolar:sn});function Kn(e){n("sum(arr)",arguments),i("arr");const t=br(e);return d(t),c(),t}function Zn(e,t){return n("min(arr, ?sorted)",arguments),i("arr"),_("sorted"),h("arr","sorted"),c(),zr(e,t)}function ec(e,t){return n("max(arr, ?sorted)",arguments),i("arr"),_("sorted"),h("arr","sorted"),c(),jr(e,t)}function tc(e){return n("prod(arr)",arguments),i("arr"),c(),dr(e)}function rc(e,t){return n("unique(arr, ?sorted)",arguments),i("arr"),_("sorted"),h("arr","sorted"),c(),mr(e,t)}function nc(e,t,r){return n("indexOf(arr, value, ?sorted)",arguments),i("arr"),a("value"),_("sorted"),h("arr","sorted"),c(),vr(e,t,r)}Object.freeze(Kn),Object.freeze(Zn),Object.freeze(ec),Object.freeze(tc),Object.freeze(rc),Object.freeze(nc),Object.freeze((function(e,t,r){return n("union(arr1, arr2, ?sorted)",arguments),i("arr1"),i("arr2"),_("sorted"),h("arr1","sorted"),h("arr2","sorted"),c(),hr(e,t,r)})),Object.freeze((function(e,t){return n("isEqual(arr1, arr2)",arguments),i("arr1"),i("arr2"),c(),wr(e,t)})),Object.freeze((function(e,t){if(n("sortUint8(arr, ?target)",arguments),e.constructor!==Uint8Array)throw"sortUint8(arr, ?target): arr must be a Uint8Array";return y("target",e.length),c(),yr(e,t)})),Object.freeze((function(e,t,r){return n("count(arr, value, ?sorted)",arguments),i("arr"),a("value"),_("sorted"),h("arr","sorted"),c(),_r(e,t,r)}));var cc=Object.freeze({__proto__:null,sum:Kn,min:Zn,max:ec,prod:tc,unique:rc,indexOf:nc}),oc=Object.freeze({__proto__:null,debug:cc,sum:br,min:zr,max:jr,prod:dr,unique:mr,indexOf:vr,union:hr,isEqual:wr,sortUint8:yr,imin:gr,imax:Or,count:_r}),fc=Object.freeze({__proto__:null});function uc(e,t){const r=e.length;let n=0;if(void 0===t)for(let t=0;t<r;t++)n+=e[t];else for(let c=0;c<r;c++)n+=e[c]*t[c];return n}function ac(e,t){const r=e.length;if(void 0===t)return uc(e)/r;{let n=0,c=0,o=0;for(let f=0;f<r;f++)o=t[f],n+=e[f]*o,c+=o;return n/c}}function ic(e,t,r=!0){const n=e.length;let c=0;const o=ac(e,t);let f=n;if(void 0===t)for(let t=0;t<n;t++){const r=e[t]-o;c+=r*r}else{f=0;for(let r=0;r<n;r++){const n=t[r];f+=n;const o=e[r]-u;c+=n*o*o}}return r&&f>1&&(f-=1),c/f}function lc(e,t,r=!0){return B(ic(e,t,r))}function sc(e,t,r=!0){meanX=ac(e),meanY=ac(t);const n=e.length;let c=0;for(let r=0;r<n;r++)c+=(e[r]-meanX)*(t[r]-meanY);return r&&n>1&&(n-=1),c/n}function bc(e,t,r=!0){if(0===e.length)return;return sc(e,t,r)/(lc(e)*lc(t))}function zc(e,t,r=!1){const n=e.length;if(0!==n){void 0===t&&([e,t]=jc(e,r)),zc={},maxValue=e[0]-1;for(let t=0;t<n;t++){const r=e[t];r>maxValue?(maxValue=r,(zc={})[r]=!0):r===maxValue&&(zc[r]=!0)}return new Float64Array(zc.keys())}}function jc(e,t=!1){const r=e.length;freqeuencies={};for(let t=0;t<r;t++){const r=e[t],n=frequencies[r];frequencies[r]=void 0===n?1:n+1}const n=new Float64Array(frequencies.keys()),c=n.length,o=new Float64Array(c);for(let e=0;e<c;e++)o[e]=frequencies[n[e]];return[n,o]}function Oc(e,t,r=!1){return _r(e,t,r)}function gc(e,t,r){return e<t||e>r?0:1/(t-r)}function dc(e,t,r){return e<t?0:e>r?1:(e-t)/(r-t)}function mc(e,t,r){return t+e*(t-r)}function vc(e,t){return t*W(-t*e)}function hc(e,t){return 1-W(-t*e)}function wc(e,t){return-J(1-e)/t}Object.freeze(uc),Object.freeze(ac),Object.freeze(ic),Object.freeze(lc),Object.freeze(sc),Object.freeze(bc),Object.freeze(zc),Object.freeze(Oc),Object.freeze(jc),Object.freeze(gc),Object.freeze(dc),Object.freeze(mc),Object.freeze(vc),Object.freeze(hc),Object.freeze(wc);var yc=Object.freeze({__proto__:null,debug:fc,sum:uc,mean:ac,variance:ic,sdev:lc,cov:sc,cor:bc,get modes(){return zc},freq:Oc,toFreq:jc,unifPdf:gc,unifCdf:dc,unifInvCdf:mc,expPdf:vc,expCdf:hc,expInvCdf:wc});function _c(e,t=e*C){const r=q(e),n=e-whole;let c=0,o=1,f=1,u=1,a=1,i=2,l=a/i;for(;E(l-e)>t;)n>l?(c=a,o=i,a+=f,i+=u):(f=a,u=i,a+=c,i+=o),l=a/i;const s=new Int32Array(2);return s[0]=a+i*r,s[1]=i,s}function Ac(e,t){return x0=t*(1+C),x1=t*(1-C),dx=x1-x0,(e(x1)-e(x0))/dx}Object.freeze(_c),Object.freeze(Ac);var pc=Object.freeze({__proto__:null,frac:_c,deriv:Ac});const xc=B(2/x),Fc=2147483647;function $c(e=0,t=1,r){if(void 0===r)return e+(t-e)*re();{const n=new Float64Array(r);for(let c=0;c<r;c++)n[c]=e+(t-e)*re();return n}}function Mc(e,t,r){const n=R(e),c=q(t)+1-n;if(void 0===r)return q(n+re()*c);{const e=new Float64Array(r);for(let t=0;t<r;t++)e[t]=q(n+c*re());return e}}function Nc(e=0,t=1,r){if(void 0!==r){const n=new Float64Array(r);let c=0;for(;c<r;){const r=re(),o=(2*re()-1)*xc/r;r*r<=W(-.5*o*o)&&(n[c++]=e+o*t)}return n}for(;;){const r=re(),n=(2*re()-1)*xc/r;if(r*r<=W(-.5*n*n))return e+n*t}}function Ic(e=1,t){if(void 0===t)return-J(re())/e;{const r=new Float64Array(t);for(let n=0;n<t;n++)r[n]=-J(re())/e;return r}}function Cc(e=0,t=1,r=Mc(1,4294967295)){let n,c;const o=function(e){return void 0!==e&&(r=q(E(e)),c=r),r},f=function(r=e,c=t){return n=((t=c)-(e=r))/2147483648,[e,t]};o(r),f(e,t);const u=function(t){if(void 0===t)return c=48271*c%Fc,e+c*n;{const r=new Float64Array(t);for(let o=0;o<t;o++)c=48271*c%Fc,r[o]=e+c*n;return r}};return u.seed=Object.freeze(o),u.range=Object.freeze(f),Object.freeze(u)}function Ec(e=0,t=1,r=Mc(1,4294967295)){const n=new Uint32Array(1);let c;const o=function(e){return void 0!==e&&(r=P(e)||1,n[0]=r),r},f=function(r=e,n=t){return c=((t=n)-(e=r))/4294967296,[e,t]};o(r),f(e,t);const u=function(e){if(void 0===e)return n[0]^=n[0]<<13,n[0]^=n[0]<<17,n[0]^=n[0]<<5,n[0]*c;{const t=new Float64Array(e);for(let r=0;r<e;r++)n[0]^=n[0]<<13,n[0]^=n[0]<<17,n[0]^=n[0]<<5,t[r]=n[0]*c;return t}};return u.seed=Object.freeze(o),u.range=Object.freeze(f),Object.freeze(u)}function Uc(e=0,t=1,r=Mc(1,4294967295)){const n=Ec(0,1,r),c=function(r){if(void 0!==r){const c=new Float64Array(r);let o=0;for(;o<r;){const r=n(),f=(2*n()-1)*xc/r;r*r<=W(-.5*f*f)&&(c[o++]=e+f*t)}return c}for(;;){const r=n(),c=(2*n()-1)*xc/r;if(r*r<=W(-.5*c*c))return e+c*t}};return c.seed=n.seed,c.mean=Object.freeze((function(t=e){return e=t})),c.sd=Object.freeze((function(e=t){return t=e})),Object.freeze(c)}const kc=Ec,Pc=Uc,Rc=function(e,t,r=Mc(1,4294967295)){const n=Ec(R(e),q(t)+1,r),c=function(e){if(void 0===e)return q(n());{const t=n(e);for(let r=0;r<e;r++)t[r]=q(t[r]);return t}};return c.seed=n.seed,c.range=Object.freeze((function(r=e,c=t){return e=r,t=c,n.range(R(e),q(t)+1),[e,t]})),Object.freeze(c)};function qc(e=1,t=Mc(1,4294967295)){const r=Ec(0,1,t),n=function(t){if(void 0===t)return-J(r())/e;{const n=new Float64Array(t);for(let c=0;c<t;c++)n[c]=-J(r())/e;return n}};return n.seed=r.seed,n.lambda=Object.freeze((function(t=e){return e=t})),Object.freeze(n)}function Xc(e=Mc(1,N)){e=ie(10.23*e,4096e3);const t=function(t){return t=le(.1031*t),t*=t+e,le(t*=t+t)};return t.seed=e,Object.freeze(t)}function Tc(e=Mc(1,N)){e=ie(10.23*e,N);const t=function(t){const r=le(.1031*t[0]),n=le(.1031*t[1]),c=Le([r,n,r],[n+e,r+e,r+e]);return le((r+n+2*c)*(r+c))};return t.seed=e,Object.freeze(t)}function Gc(e){return e*e*e*(e*(6*e-15)+10)}function Sc(e=[0,1],t=Mc(1,Number.MAX_SAFE_INTEGER)){const r=Xc(t),n=e[0],c=.5*(n+e[1]),o=2*(c-n),f=function(e){const t=q(e),n=t+1,f=r(t),u=r(n),a=e-t;return c+ae(f*a,u*(a-1),Gc(a))*o};f.seed=t;f.deriv=Object.freeze((function(e){const t=q(e),n=t+1,c=r(t),f=e-t;return(r(n)*(f-1)-c*f)*((u=f)*u*(30+u*(30*u+60)))*o;var u}));return f.grid=Object.freeze((function(e,t,n){const c=q(e),o=q(e+t*n)-c,f=new Float64Array(t),u=e+t*n,a=1e-4*n;let i=e-c,l=0,s=0,b=0,z=r(c),j=n*z;for(let e=0;e<o;e++){s=z,b=j,z=r(e+1),j=z*n,c0=i*s,c1=(i-1)*z;const t=e===o-1?u-maxCellX+a:1+a;for(;i<t;)f[l++]=ae(c0,c1,Gc(i)),c0+=b,c1+=j;i-=1}return f})),Object.freeze(f)}function Vc(e){return e*e*e*(e*(6*e-15)+10)}Object.freeze($c),Object.freeze(Mc),Object.freeze(Nc),Object.freeze(Ic),Object.freeze(Cc),Object.freeze(Ec),Object.freeze(Uc),Object.freeze(kc),Object.freeze(Rc),Object.freeze(Pc),Object.freeze(qc),Object.freeze(Xc),Object.freeze(Tc),Object.freeze(Sc);const Lc=function(e,t,r,n,c,o){const f=Vc(c),u=Vc(o),a=ae(e,t,u),i=ae(r,n,u);return ae(a,i,f)};function Dc(e,t,r){return n("unif(?a, ?b, ?count)",arguments),w("a"),w("b"),p("count"),c(),$c(e,t,r)}function Bc(e,t,r){return n("int(a, b, ?count)",arguments),w("a"),w("b"),p("count"),c(),Mc(e,t,r)}function Qc(e,t,r){return n("norm(?mean, ?sd, ?count)",arguments),w("mean"),w("sd"),A("sd"),p("count"),c(),Nc(e,t,r)}function Yc(e,t){return n("exp(?lambda, ?count)",arguments),w("lambda"),p("count"),c(),Ic(e,t)}function Hc(e,t,r){return n("MCG(?a, ?b, ?seed)",arguments),a(e,signature),a(t,signature),O(r),Cc(e,t,r)}function Wc(e=0,t=1,r=Mc(1,4294967295)){return n("Xorshift32(?a, ?b, ?seed)",arguments),a(e,signature),a(t,signature),O(r),Ec(e,t,r)}function Jc(e=0,t=1,r=Mc(1,4294967295)){return n("RU(?mean, ?sd, ?seed)",arguments),a(e,signature),a(t,signature),b(t,signature),O(r),Uc(e,t,r)}const Kc=Wc,Zc=Jc,eo=function(e,t,r=Mc(1,4294967295)){return n("Int(a, b, ?seed)",arguments),a(e,signature),a(t,signature),O(r),Rc(e,t,r)};function to(e=1,t=Bc(1,4294967295)){}Object.freeze(Dc),Object.freeze(Bc),Object.freeze(Qc),Object.freeze(Yc),Object.freeze(Hc),Object.freeze(Wc),Object.freeze(Jc),Object.freeze(Kc),Object.freeze(eo),Object.freeze(Zc),Object.freeze(to);var ro=Object.freeze({__proto__:null,unif:Dc,int:Bc,norm:Qc,exp:Yc,MCG:Hc,Xorshift32:Wc,RU:Jc,Unif:Kc,Int:eo,Norm:Zc,Exp:to}),no=Object.freeze({__proto__:null,debug:ro,unif:$c,int:Mc,norm:Nc,exp:Ic,MCG:Cc,Xorshift32:Ec,RU:Uc,Unif:kc,Int:Rc,Norm:Pc,Exp:qc,Float1to1:Xc,Float2to1:Tc,Perlin1D:Sc,Perlin2D:function(e=[0,1],t=Mc(1,1e3)){const r=Tc(t);function n(e,t){const n=2*M*r([e,t]);return[G(n),X(n)]}const c=e[0],o=(e[1]-c)/2,f=c+o,u=o/(.5*B(2)),a=function(e,t){const r=q(e),c=q(t),o=r+1,a=c+1,i=e-r,l=t-c,s=n(r,c),b=n(r,a),z=n(o,c),j=n(o,a),O=Ve(s,[i,l]),g=Ve(b,[i,l-1]),d=Ve(z,[i-1,l]),m=Ve(j,[i-1,l-1]),v=Lc(O,g,d,m,i,l);return f+v*u};return a.deriv=Object.freeze((function(e,t){const r=q(e),c=q(t),o=r+1,f=c+1,a=e-r,i=t-c,l=n(r,c),s=n(r,f),b=n(o,c),z=n(o,f),j=Ve(l,[a,i]),O=Ve(s,[a,i-1]),g=Ve(b,[a-1,i]),d=Ve(z,[a-1,i-1]),m=Vc(i),v=ae(j,O,m),h=ae(g,d,m),w=30*a*a*(a*(a-2)+1),y=30*i*i*(i*(i-2)+1),_=Ye(Ye(l,ft(Ke(b,l),w)),[w*(g-j),0]),A=Ye(Ye(s,ft(Ke(z,s),w)),[w*(d-O),0]);let p=Ye(Ye(_,ft(Ke(A,_),y)),[0,y*(h-v)]);return p=ft(p,u),p})),a.grid=Object.freeze((function(e,t,r,c,o,a){const i=1e-5*o,l=1e-5*(a=null==a?o:a),s=e+(r-1)*o,b=t+(c-1)*a,z=q(e),j=q(t),O=R(s)-1,g=R(b)-1,d=1+g-j,m=1+O-z;let v,h,w,y,_,A,p,x,F,$,M,N,I,C,E,U,P,X,T,G,S,V,L,D,B,Q=new Float32Array(r*c),Y=0,H=e-z,W=t-j,J=Array(d+1),K=Array(d+1);for(L=0;L<=d;L++)[v,h]=n(z,j+L),K[L]=[v,h,v*o,h*a];for(p=z,w=H,V=0;V<m;V++){for(Y=k((p+w-e)/o),x=j,y=W,_=V===m-1?s-O+i:1+i,S=J,J=K,K=S,[v,h]=n(p,x),K[0]=[v,h,v*o,h*a],L=0;L<d;L++){for(D=L+1,w=H,A=D===d?b-g+l:1+l,I=J[L],C=J[D],E=K[L],[v,h]=n(p,x+D),U=[v,h,v*o,h*a],K[D]=U,P=Ve([w,y],I),X=Ve([w,y-1],C),T=Ve([w-1,y],E),G=Ve([w-1,y-1],U);y<=A;){for(B=Y,w=H,F=P,$=X,M=T,N=G;w<=_;)Q[B++]=f+u*Lc(F,$,M,N,w,y),w+=o,F+=I[2],$+=C[2],M+=E[2],N+=U[2];y+=a,Y+=r,P+=I[3],X+=C[3],T+=E[3],G+=U[3]}x++,y--}H=--w,p++}return Q.nrows=c,Q.ncols=r,Q})),a.fbm=Object.freeze((function(e,t,r=5,n=1.5,c=.7){let o=0,f=1,u=1;for(;r--;)o+=f*a(e,t),u+=f,f*=c,e=e*n+.3,t=t*n+.3;return o/=u,o})),a.seed=t,a.dimension=2,a}});return e.VERSION="beta-4.0.0",e.array=oc,e.complex=Jn,e.integer=Ge,e.matrix=Kr,e.numerical=pc,e.random=no,e.standard=we,e.statistics=yc,e.vector=lr,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
