var Mathicall=function(n){"use strict";function r(n={},r="",t=""){for(const o in n)if((e=o[1]).constructor!==Number||!isFinite(e))throw`[${t}] ${r}: ${o[0]} must be numeric.`;var e}function t(n={},r="",t=""){for(const e in n)if(!isInteger(e[1]))throw`[${t}] ${r}: ${e[0]} must be an integer.`}function e(n,r="",t=""){(n>Number.MAX_SAFE_INTEGER||n<Number.MIN_SAFE_INTEGER)&&console.warn(`[${t}] ${r} large: returned value is approximate.`),n===Number.MAX_VALUE&&console.warn(`[${t}] ${r} overflow: returned Number.MAX_VALUE.`)}const o=Math.E,u=Math.LN2,a=Math.SQRT2,c=Math.PI,l=Math.abs,i=Math.sign,f=Math.round,s=Math.trunc,m=Math.ceil,w=Math.floor,g=Math.sin,d=Math.asin,A=Math.cos,_=Math.acos,h=Math.tan,b=Math.atan,y=Math.atan2,F=Math.sqrt,p=Math.cbrt,M=Math.hypot,v=Math.pow,z=Math.exp,O=Math.log,x=Math.log2,E=Math.log10,N=Math.max,j=Math.min,I=Math.random,$=180/c,L=1/$,R=2*c,T=.5*c,V=1/c;function P(n,r,t){return n+(r-n)*t}function X(n,r){return(n%r+r)%r}function S(n){return n-s(n)}function U(n){return n*$}function D(n){return n*L}var G=Object.freeze({__proto__:null,lerp:function(n,t,e){return r({x:n,y:t,r:e},"lerp(x, y, r)","std.debug"),P(n,t,e)},mod:function(n,t){return r({x:n,m:t},"mod(x, m)","std.debug"),X(n,t)},fract:function(n){return r({x:n},"fract(x)","std.debug"),S(n)},deg:function(n){return r({radians:n},"deg(radians)","std.debug"),U(n)},rad:function(n){return r({degrees:n},"rad(degrees)","std.debug"),D(n)}}),q=Object.freeze({__proto__:null,debug:G,E:o,LN2:u,SQRT2:a,PI:c,abs:l,sign:i,round:f,trunc:s,ceil:m,floor:w,sin:g,asin:d,cos:A,acos:_,tan:h,atan:b,atan2:y,sqrt:F,cbrt:p,hypot:M,pow:v,exp:z,ln:O,log2:x,log10:E,max:N,min:j,random:I,RAD_TO_DEG:$,DEG_TO_RAD:L,TWO_PI:R,HALF_PI:T,INV_PI:V,lerp:P,mod:X,fract:S,deg:U,rad:D});function B(n){let r=30;if(n.constructor!==Number||!isFinite(n))throw"precomputeBinomials takes numeric input";r=l(f(n));const t=.5*++r*(r+1),e=new Float64Array(t);let o=-1;for(let n=0;n<r;n++){e[o++]=1;for(let r=1;r<n;r++)e[o]=e[o-n-1]+e[o-n],o++;e[o++]=1}return e}const k=function(){const n=new Float64Array(171);n[0]=1;for(let r=1;r<171;r++)n[r]=r*n[r-1];return n}();let Q=B(30);function H(n){if(!(n<0))return n>170?Number.MAX_VALUE:k[n]}function W(n,r){if(r>n||n<0||r<0)return 0;if(n<=30)return Q[.5*n*(n+1)+r];const t=j(r,n-r);if(t>514)return Number.MAX_VALUE;const e=n-t;let o=1,u=1;for(;u<=t;)o*=(e+u)/u++;return o}function C(n,r){if(r>n||n<0||r<0)return 0;if(r>170)return Number.MAX_VALUE;if(r=n-r,n<171)return f(k[n]/k[r]);let t=1;for(r<160&&(t=f(k[170]/k[r]),r=170);r<n;)t*=++r;return t}function J(n,r){if(n=l(n),r=l(r),0===n)return r;if(0===r)return n;if(n<4294967296&&r<4294967296){let t=0;for(;0==(1&(n|r));)n>>>=1,r>>>=1,t++;for(;0==(1&n);)n>>>=1;for(;0!==r;){for(;0==(1&r);)r>>>=1;if(n>r){const t=n;n=r,r=t}r-=n}return n<<t}for(;n!==r;)n>r?n-=r:r-=n;return n}function K(n,r){return 0===n||0===r?0:l(n/J(n,r)*r)}function Y(n,r,t){if(n=l(n),r=l(r),1===t)return 0;{let e=1;for(n%=t;r>0;)1&r&&(e=e*n%t),r>>=1,n=n**2%t;return e}}var Z=Object.freeze({__proto__:null,factorial:function(n){t({n:n},"factorial(n)","int.debug");const r=H(n);return e(r,"factorial(n)","int.debug"),r},choose:function(n,r){t({n:n,r:r},"choose(n, r)","int.debug");const o=W(n,r);return e(o,"choose(n, r)","int.debug"),o},permute:function(n,r){t({n:n,r:r},"permute(n, r)","int.debug");const o=C(n,r);return e(o,"permute(n, r)","int.debug"),o},gcd:function(n,r){return t({a:n,b:r},"gcd(a, b)","int.debug"),J(n,r)},lcm:function(n,r){return t({a:n,b:r},"lcm(a, b)","int.debug"),K(n,r)},mpow:function(n,r,e){return t({base:n,exp:r,m:e},"mpow(base, exp, m)","int.debug"),Y(n,r,e)}}),nn=Object.freeze({__proto__:null,debug:Z,precomputeBinomials:B,factorial:H,choose:W,permute:C,gcd:J,lcm:K,mpow:Y});function rn(n,r){let t=0;const e=n.length;for(let o=0;o<e;o++)t+=n[o]*r[o];return t}function tn(n,r){return n[0]*r[0]+n[1]*r[1]}function en(n,r){return n[0]*r[0]+n[1]*r[1]+n[2]*r[2]}function on(n,r){return n[0]*r[0]+n[1]*r[1]+n[2]*r[2]+n[3]*r[3]}function un(n){return M(...n)}function an(n){return M(n[0],n[1])}function cn(n){return M(n[0],n[1],n[2])}function ln(n){return M(n[0],n[1],n[2],n[3])}var fn=Object.freeze({__proto__:null,dot:rn,dot2:tn,dot3:en,dot4:on,cross3:function(n,r,t=new Float64Array(3)){return t[0]=n[1]*r[2]-n[2]*r[1],t[1]=n[2]*r[0]-n[0]*r[2],t[2]=n[0]*r[1]-n[1]*r[0],t},add:function(n,r,t=new Float64Array(n.length)){const e=n.length;for(let o=0;o<e;o++)t[o]=n[o]+r[o];return t},add2:function(n,r,t=new Float64Array(2)){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t},add3:function(n,r,t=new Float64Array(3)){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t},add4:function(n,r,t=new Float64Array(4)){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t},sub:function(n,r,t=new Float64Array(n.length)){const e=n.length;for(let o=0;o<e;o++)t[o]=n[o]-r[o];return t},sub2:function(n,r,t=new Float64Array(2)){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t},sub3:function(n,r,t=new Float64Array(3)){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t},sub4:function(n,r,t=new Float64Array(4)){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t},mag:un,mag2:an,mag3:cn,mag4:ln,smult:function(n,r,t=new Float64Array(n.length)){const e=n.length;for(let o=0;o<e;o++)t[o]=n[o]*r;return t},smult2:function(n,r,t=new Float64Array(2)){return t[0]=n[0]*r,t[1]=n[1]*r,t},smult3:function(n,r,t=new Float64Array(3)){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t},smult4:function(n,r,t=new Float64Array(4)){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t},normalize:function(n,r){return scale(n,1/un(n),r)},normalize2:function(n,r){return scale2(n,1/an(n),r)},normalize3:function(n,r){return scale3(n,1/cn(n),r)},normalize4:function(n,r){return scale4(n,1/ln(n),r)},angle:function(n,r){return _(rn(n,r)/(un(n)*un(r)))},angle2:function(n,r){return _(tn(n,r)/(an(n)*an(r)))},angle3:function(n,r){return _(en(n,r)/(cn(n)*cn(r)))},angle4:function(n,r){return _(on(n,r)/(ln(n)*ln(r)))},fract:function(n,r=new Float64Array(n.length)){const t=n.length;for(let e=0;e<t;e++)r[e]=S(n[e]);return r},fract2:function(n,r=new Float64Array(2)){return r[0]=S(n[0]),r[1]=S(n[1]),r},fract3:function(n,r=new Float64Array(3)){return r[0]=S(n[0]),r[1]=S(n[1]),r[2]=S(n[2]),r},fract4:function(n,r=new Float64Array(4)){return r[0]=S(n[0]),r[1]=S(n[1]),r[2]=S(n[2]),r[3]=S(n[3]),r},polar2:function(n,r=new Float64Array(2)){r[0]=an(n),r[1]=y(n[1],n[0])+c}});var sn=Object.freeze({__proto__:null,dot2:function(n,r){return n[0]*r[0]*A(n[1]-r[1])},mag:function(n){return l(n[0])},smult2:function(n,r,t=new Float64Array(2)){t[0]=n[0]*r,t[1]=X(n[1],R)},normalize2:function(n,r=new Float64Array(2)){r[0]=1,r[1]=X(n[1],R)},rect2:function(n,r=new Float64Array(2)){const t=n[0],e=n[1];return r[0]=t*A(e),r[1]=t*g(e),r}}),mn=Object.freeze({__proto__:null,rect:fn,polar:sn});var wn=Object.freeze({__proto__:null,zeros:function(n,r){const t=new Float64Array(n*r);return t.rows=n,t.cols=r,t},constant:function(n,r,t){const e=new Float64Array(n*r);return e.fill(t),e.rows=n,e.cols=r,e},identity:function(n){const r=n*n,t=n+1,e=new Float64Array(r);for(let n=0;n<r;n+=t)e[n]=1;return e.rows=n,e.cols=n,e},flatten:function(n,r=new Float64Array(n.length*n[0].length)){const t=n.length,e=n[0].length;for(let o=0;o<t;o++)for(let u=0;u<e;u++)r[o*t+u]=n[o][u];return r.rows=t,r.cols=e,r},smult:function(n,r,t=new Float64Array(n.length)){const e=n.length;for(let o=0;o<e;o++)t[o]=n[o]*r;return t.rows=n.rows,t.cols=n.cols,t},transpose2:function(n,r=new Float64Array(4)){r[0]=n[0],r[3]=n[3];const t=n[1];return r[1]=n[2],r[2]=t,r.rows=2,r.cols=2,r},transpose3:function(n,r=new Float64Array(9)){r[0]=n[0],r[4]=n[4],r[8]=n[8];let t=n[1];return r[1]=n[3],r[3]=t,t=n[2],r[2]=n[6],r[6]=t,t=n[5],r[5]=n[7],r[7]=t,r.rows=3,r.cols=3,r},transpose4:function(n,r=new Float64Array(16)){r[0]=n[0],r[5]=n[5],r[10]=n[10],r[15]=n[15];let t=n[1];return r[1]=n[4],r[4]=t,t=n[2],r[2]=n[8],r[8]=t,t=n[3],r[3]=n[12],r[12]=t,t=n[6],r[6]=n[9],r[9]=t,t=n[7],r[7]=n[13],r[13]=t,t=n[11],r[11]=n[14],r[14]=t,r.rows=4,r.cols=4,r},mmult:function(n,r){const t=n.rows,e=n.cols,o=(r.rows,r.cols),u=new Float64Array(t*o);u.rows=t,u.cols=o;let a=0,c=0,l=0;for(let i=0;i<t;i++)for(let t=0;t<o;t+=1){a=0,c=e*i,l=t;for(let t=0;t<e;t+=1)a+=n[c]*r[l],c+=1,l+=o;u[i*o+t]=a}return u},size:function(n){return[n.rows,n.cols]},det2:function(n){return n[0]*n[3]-n[1]*n[2]},inverse2:function(n,r=new Float64Array(4)){const t=n[0],e=n[1],o=n[2],u=n[3],a=t*u-e*o;if(0===a)return;const c=1/a;return r[0]=u*c,r[3]=t*c,r[1]=-e*c,r[2]=-o*c,r.rows=2,r.cols=2,r}});var gn=Object.freeze({__proto__:null,conj:function(n,r=new Float64Array(2)){return r[0]=n[0],r[1]=-n[1],r},real:function(n){return n[0]},imag:function(n){return n[1]},arg:function(n){return y(n[1],n[0])},abs:function(n){return M(n[0],n[1])},add:function(n,r,t=new Float64Array(2)){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t},sub:function(n,r,t=new Float64Array(2)){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t},cmult:function(n,r,t=new Float64Array(2)){const e=n[0],o=n[1],u=r[0],a=r[1];return t[0]=e*u-o*a,t[1]=e*a-u*o,t},smult:function(n,r,t=new Float64Array(2)){return t[0]=n[0]*r,t[1]=n[1]*r,t},div:function(n,r,t=new Float64Array(2)){const e=n[0],o=n[1],u=r[0],a=r[1],c=1/(u*u+a*a);return t[0]=(e*u+o*a)*c,t[1]=(-e*a-u*o)*c,t},inverse:function(n,r=new Float64Array(2)){n[0],n[1];const t=1/(re2*re2+im2*im2);return r[0]=(re1*re2+im1*im2)*t,r[1]=(-re1*im2-re2*im1)*t,r},polar:function(n,r=new Float64Array(2)){const t=n[0],e=n[1],o=M(t,e);return r[0]=o,r[1]=y(e,t),r}});function dn(n){return(n%=R)>c?n-R:n<-c?n+R:n}var An=Object.freeze({__proto__:null,conj:function(n,r=new Float64Array(2)){const t=n[0],e=n[1];return t<0?(r[0]=-t,r[1]=-dn(e+c)):(r[0]=t,r[1]=-dn(e)),r},real:function(n){return n[0]*A(n[1])},imag:function(n){return n[0]*g(n[1])},arg:function(n){return dn(n[1])},abs:function(n){return l(n[0])},smult:function(n,r,t=new Float64Array(2)){const e=n[0]*r,o=n[1];return e<0?(t[0]=-e,t[1]=dn(o+c)):(t[0]=e,t[1]=dn(o)),t},cmult:function(n,r,t=new Float64Array(2)){const e=n[0]*r[0],o=n[1]+r[1];return e<0?(t[0]=-e,t[1]=dn(o+c)):(t[0]=e,t[1]=dn(o)),t},div:function(n,r,t=new Float64Array(2)){const e=r[0];if(0===e)return;const o=n[0]/e,u=n[1]-r[1];return o<0?(t[0]=-o,t[1]=dn(u+c)):(t[0]=o,t[1]=dn(u)),t},pow:function(n,r,t=new Float64Array(2)){const e=n[0],o=n[1];return e<0?(t[0]=v(-e,r),t[1]=dn(r*(o+c))):(t[0]=v(e,r),t[1]=dn(r*o)),t},inverse:function(n,r=new Float64Array(2)){const t=n[0];if(0===t)return;const e=n[1];return t<0?(r[0]=-1/t,r[1]=dn(-e-c)):(r[0]=1/t,r[1]=dn(-e)),r},rect:function(n,r=new Float64Array(2)){const t=n[0],e=n[1];return r[0]=t*A(e),r[1]=t*g(e),r}}),_n=Object.freeze({__proto__:null,rect:gn,polar:An});var hn=Object.freeze({__proto__:null,sum:function(n){const r=n.length;let t=0;for(let e=0;e<r;e++)t+=n[e];return t},min:function(n,r=!1){const t=n.length;if(r)return j(n[0],n[t-1]);let e=n[0],o=0;for(let r=1;r<t;r++)o=n[r],o<e&&(e=o);return e},max:function(n,r=!1){const t=n.length;if(r)return N(n[0],n[t-1]);let e=n[0],o=0;for(let r=1;r<t;r++)o=n[r],o>e&&(e=o);return e},prod:function(n){const r=n.length;let t=n[0];for(let e=1;e<r;e++)t*=n[e];return t},unique:function(n,r=!1){const t=n.length;if(r){const r=new Float64Array(t);let e=0,o=0,u=n[0],a=0;for(;a<t;)for(resultBlock[e++]=u,o=u;u===o;)u=n[a++];return r.slice(0,e)}{const r={};let e=0;for(let o=0;o<t;o++)e=n[o],r[e]=e;return new Float64Array(r.values())}},indexOf:function(n,r,t=!1){const e=n.length;if(!t||e<=64){for(let t=0;t<e;t++)if(n[t]===r)return t}else{let t=0,o=e-1,u=n[t],a=n[o],c=0,l=0;if(u>a){if(u<r||a>r)return-1;for(;o-t>64;)c=w(.5*(t+o)),l=n[c],l>r?t=c:o=c}else{if(u>r||a<r)return-1;for(;o-t>64;)c=w(.5*(t+o)),l=n[c],l<r?t=c:o=c}for(;t<=o;){if(array[t]===r)return t;t++}}return-1}});return n.VERSION="beta-3.0.0",n.array=hn,n.complex=_n,n.integer=nn,n.matrix=wn,n.standard=q,n.vector=mn,Object.defineProperty(n,"__esModule",{value:!0}),n}({});
